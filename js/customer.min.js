/*!
 * project : customer
 * author : LINOFFICE
 * 고객센터
 */ includeHTML(document.querySelector("#svg-container"),"https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/svg.html",cacheVersion),$("#tab_"+pageCnbSubType).addClass("on");const is_gm=account&&account.gm,account_name=account?account.name:"";var paginationRendere=function(){$(".pagination-container").pagination({dataSource:function(e){getDatasWithOption([{type:"POST",url:"/define/customer",dataType:"json",contentType:"application/json",Accept:"application/json",data:{type:pageCnbSubType,login:account_name}}],t=>{var a=`<div class="notice ng-scope"><strong class="ng-binding ng-scope">[ ${account_name} ]님의 최근 6개월간 ${1==pageCnbSubType?`문의`:`신고 / 이의`}${t&&t.length?`내역입니다.`:`내역이 없습니다.`}</strong><button onClick="customWrite('${pageCnbSubType}')" style="float: right; width: 115px; height: 39px; background: #6e7482 none; color: #fff; font-size: 16px; font-weight: 600; margin-top: -7px;">${1==pageCnbSubType?`문의`:`신고`}하기</button></div><table class="table_list ng-scope"></table>`;$("#custom_main").prepend(a),e(t)},e=>{throw Error("rendaring from customer.js Error")})},pageSize:5,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(e,t){var a="";a+=`<tbody><tr><th class="th_part">계정</th><th class="th_subject">제목</th><th class="th_status">처리상태</th><th class="th_status_date">등록일</th></tr></tbody><tbody>`,e.length>0&&$.each(e,function(e,t){a+=`<tr class="ng-scope" data-id="${t.id}" onClick="customView('${pageCnbSubType}', ${t.rownum});"><td class="ng-binding">${t.login}</td><td class="subject"><a class="ng-binding">${t.title}</a></td><td class="ng-binding ng-scope">${t.status}</td><td class="date ng-binding">${moment(new Date(t.date)).format("YYYY-MM-DD")}</td></tr>`}),a+="</tbody>",$(".table_list").html(a)}})},customViewBackBtn=function(){$(".table_view").html(""),paginationRendere()};function customView(e,t){getDatasWithOption([{type:"POST",url:"/define/customer/view",dataType:"json",contentType:"application/json",Accept:"application/json",data:{type:e,rownum:t}}],a=>{if(a){var n=`<div class="table_view ng-scope"><header class="view_subject ng-scope"><p class="ng-binding">${a.title}</p><a id="layer_open" class="btn_delete" href="javascript:customDelete(${e}, ${a.rownum})">${"1"==e?`문의삭제`:`신고삭제`}</a></header>`+("답변 완료"==a.status?`<div class="ng-scope"><div class="view reply subject"><header class="ng-binding">[답변]<span class="date ng-binding">${moment(new Date(a.commentDate)).format("YYYY-MM-DD HH:mm:ss")}</span></header><article class="ng-binding">${a.comment}</article></div></div>`:"")+'<div class="ng-scope"><div class="view">'+`<header class="ng-binding req">${"1"==e?`[문의]`:`[신고]`}&nbsp;${a.login}<span class="date ng-binding">${moment(new Date(a.date)).format("YYYY-MM-DD HH:mm:ss")}</span></header>`+`<article class="ng-binding">${a.content}</article>`+("접수 완료"==a.status&&is_gm?`<div class="custom_comment"><textarea id="testContent" name="comment" required="" placeholder="답변을 입력하세요" maxlength="4500" class="ng-pristine ng-invalid ng-invalid-required ng-valid-maxlength"></textarea><p class="btn_typeA_gray clear" onClick="commentWriteSubmit(${e}, ${t});"><span class="btn" id="spnRemoveContent">답변</span></p></div>`:"")+"</div></div>"+`<div class="button ng-scope" style="padding-bottom: 60px;"><p class="btn_typeA" onClick="customViewBackBtn();"><span class="btn">목록</span></p></div>`+"</div>";$(".notice").remove(),$(".table_list").remove(""),$(".pagination-container").html(""),$(".table_view").html(n)}},e=>{throw Error("customView from customer.js Error")})}function customDelete(e,t){popupShow("정말로 삭제하시겠습니까?",`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:customDeleteAction(${e}, ${t});" class="close">예</a></span>`)}function customDeleteAction(e,t){getDatasWithOption([{type:"POST",url:"/define/customer/delete",dataType:"json",contentType:"application/json",Accept:"application/json",data:{type:e,rownum:t}}],e=>{e?(customViewBackBtn(),popupClose()):popupShow("삭제실패.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},e=>{throw Error("customDeleteAction from customer.js Error")})}function customWrite(e){var t=`<div class="faq_write" id="inquiryWrite"><form id="addTicket" name="addTicket" class="ng-pristine ng-invalid ng-invalid-required"><input type="hidden" name="customType" value="${e}" /><table class="inquiryFormTalbe"><caption><em>*</em> 표시는 필수항목이므로 반드시 기재해주세요</caption><tbody class="ng-scope ng-pristine ng-valid"><tr class="inquiry ng-scope"><th class="ng-binding"><em>*</em>${"1"===e?`문의제목`:`신고제목`}</th><td class="subject"><input type="text" id="testSubject" name="subject" required="" placeholder="제목을 입력하세요" maxlength="50" class="ng-pristine ng-valid-maxlength ng-valid-minlength ng-invalid ng-invalid-required"></td></tr></tbody><tbody class="ng-scope ng-pristine ng-valid"><tr class="inquiry ng-scope"><th class="ng-binding"><em>*</em>${"1"===e?`문의내용`:`신고내용`}</th><td><span class="txt ng-binding"><ul><li>불법 프로그램 / 버그 신고 시 육하원칙을 근거로 접수 부탁 드립니다.(보상: 중대성에 따라 지급)</li>  <li><strong><em>허위 신고 시 계정에 대한 제재가 이루어집니다.</em></strong></li> </ul></span><textarea id="testContent" name="content" required="" placeholder="내용을 입력하세요" maxlength="4500" class="ng-pristine ng-invalid ng-invalid-required ng-valid-maxlength"></textarea></td></tr></tbody></table><div class="button"><p class="btn_typeA" onClick="writeFormSubmit();"><span class="btn">${"1"===e?`문의 접수`:`신고 접수`}</span></p><p class="btn_typeA_gray clear" onClick="writeFormReset();"><span class="btn" id="spnRemoveContent">내용 삭제</span></p></div></form></div>`;$(".notice").remove(),$(".table_list").remove(""),$(".pagination-container").html(""),$("#custom_main").prepend(t)}var writeFormReset=function(){var e=document.addTicket;e.subject.value="",e.content.value=""},writeFormSubmit=function(){var e=document.addTicket;if(!e.subject.value){popupShow("제목을 입력해 주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),e.subject.focus();return}if(!e.content.value){popupShow("내용을 입력해 주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),e.content.focus();return}getDatasWithOption([{type:"POST",url:"/define/customer/insert",dataType:"json",contentType:"application/json",Accept:"application/json",data:$(e).serialize()}],e=>{e?(popupShow("접수 완료.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),$("#inquiryWrite").remove(),paginationRendere()):popupShow("접수 실패.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},e=>{throw Error("writeFormSubmit from customer.js Error")})},commentWriteSubmit=function(e,t){var a=$(".custom_comment > textarea");if(!a.val().length){popupShow("답변을 입력해 주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),a.focus();return}if(confirm("답변을 완료하시겠습니까?")){var n={type:e,rownum:t,comment:$(a).val()};getDatasWithOption([{type:"POST",url:"/define/customer/comment/insert",dataType:"json",contentType:"application/json",Accept:"application/json",data:n}],e=>{e?customViewBackBtn():popupShow("답변 실패",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},e=>{throw Error("commentWriteSubmit from customer.js Error")})}},normalList=function(){$(".tabmenue-area").css("display","none"),$(".table_view").html(""),$(".notice").remove(),$(".table_list").remove(""),$(".pagination-container").html(""),$(".faq_write").remove(),$(".detailFaqAddForm").remove(),$(".btns-add").remove(),paginationNormalRendere()},paginationNormalRendere=function(){$(".pagination-container").pagination({dataSource:function(e){getDatas(["/define/customer/normal"],t=>{var a=`<table class="table_list ng-scope"></table>${is_gm?`<div class="btns-add"><button type="button" onClick="detailFaqAddForm();" >추가</button></div>`:""}`;$("#custom_main").prepend(a),e(t)},e=>{throw Error("paginationNormalRendere from customer.js Error")})},pageSize:5,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(e,t){var a=`<tbody><tr><th class="th_part">서비스</th><th class="th_subject">자주 묻는 질문</th></tr></tbody><tbody>`;e.length>0&&$.each(e,function(e,t){a+=`<tr class="ng-scope" onClick="detailFaq(${t.id});"><td class="ng-binding normalFrontIcon">Q</td><td class="subject"><a class="ng-binding">${t.title}</a><span class="arrowQ"></span><div class="detailFaq detailFaq${t.id}"><div class="normalContent">${t.content}</div>`+(is_gm?`<div class="btns"><a href="#" onClick="detailFaqUpdate(${t.id}, event);">수정</a><a href="#" onClick="detailFaqDelete(${t.id}, event);">삭제</a></div>`:"")+"</div></td></tr>"}),a+="</tbody>",$(".table_list").html(a)}})},detailFaqAddForm=function(){var e=`<div class="detailFaqAddForm"><div class="detail-item"><label>제목</label><input type="text" class="faqTitle" name="faqTitle" placeholder="제목을 입력하세요." /></div><div class="detail-item"><label>내용</label><textarea class="faqContent" name="faqContent" placeholder="내용을 입력하세요." ></textarea></div><div class="btns"><button type="button" onClick="detailFaqAddCancle();">취소</button><button type="button" onClick="detailFaqAddComplete();">완료</button></div>`;$(".table_view").html(""),$(".notice").remove(),$(".table_list").remove(""),$(".pagination-container").html(""),$(".faq_write").remove(),$(".detailFaqAddForm").remove(),$(".btns-add").remove(),$("#custom_main").prepend(e)},detailFaqAddCancle=function(){normalList()},detailFaqAddComplete=function(){var e=$(".detailFaqAddForm .faqTitle").val(),t=$(".detailFaqAddForm .faqContent").val();if(!e.length||!t.length){popupShow("필수항목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}getDatasWithOption([{type:"POST",url:"/define/customer/normal/insert",dataType:"json",contentType:"application/json",Accept:"application/json",data:{faqTitle:e,faqContent:t}}],e=>{e&&normalList()},e=>{throw Error("detailFaqAddComplete from customer.js Error")})},detailFaqUpdate=function(e,t){var a=$(".detailFaq"+e).parent(".subject").find(".ng-binding").html(),n=$(".detailFaq"+e).children(".normalContent").html(),s=`<div class="faqUpdateForm"><input type="hidden" class="faqId" name="faqId" value="${e}" /><input type="hidden" class="faqCon" name="faqCon" value="${n}" /><input type="text" class="faqTitle" name="faqTitle" value="${a}" /><textarea class="faqContent" name="faqContent" value="${n}">${n}</textarea><div class="btns"><button type="button" onClick="detailFaqUpdateComplete(${e}, event);">완료</button><button type="button" onClick="detailFaqUpdateCancle(${e}, event);">취소</button></div></div>`;$(".detailFaq"+e).html(s),$(".detailFaq"+e).closest(".ng-scope").addClass("up"),eventStop(t)},detailFaqUpdateComplete=function(e,t){var a=$(".detailFaq"+e).find(".faqTitle").val(),n=$(".detailFaq"+e).find(".faqContent").val();getDatasWithOption([{type:"POST",url:"/define/customer/normal/update",dataType:"json",contentType:"application/json",Accept:"application/json",data:{faqId:e,faqTitle:a,faqContent:n}}],t=>{if(t){$(".detailFaq"+e).parent(".subject").find(".ng-binding").html(a);var s=`<div class="normalContent">${n}</div>`+(is_gm?`<div class="btns"><a href="#" onClick="detailFaqUpdate(${e}, event);">수정</a><a href="#" onClick="detailFaqDelete(${e}, event);">삭제</a>`:"")+"</div>";$(".detailFaq"+e).html(s),$(".detailFaq"+e).closest(".ng-scope").removeClass("up")}},e=>{throw Error("detailFaqUpdateComplete from customer.js Error")}),eventStop(t)},detailFaqUpdateCancle=function(e,t){$(".detailFaq"+e).closest(".ng-scope").removeClass("up");var a=`<div class="normalContent">${$(".detailFaq"+e).find(".faqCon").val()}</div>`+(is_gm?`<div class="btns"><a href="#" onClick="detailFaqUpdate(${e}, event);">수정</a><a href="#" onClick="detailFaqDelete(${e}, event);">삭제</a>`:"")+"</div>";$(".detailFaq"+e).html(a),eventStop(t)},detailFaqDelete=function(e,t){confirm("정말로 삭제 하시겠습니까?")&&getDatasWithOption([{type:"POST",url:"/define/customer/normal/delete",dataType:"json",contentType:"application/json",Accept:"application/json",data:{id:e}}],e=>{e&&($(".table_list").remove(),paginationNormalRendere())},e=>{throw Error("detailFaqDelete from customer.js Error")}),eventStop(t)},detailFaq=function(e){return!$(".detailFaq").closest(".ng-scope").hasClass("up")&&($(".detailFaq"+e).hasClass("selected")?($(".detailFaq"+e).parent(".subject").find("span").removeClass("selected"),$(".detailFaq"+e).removeClass("selected"),$(".detailFaq"+e).slideUp()):($(".detailFaq").parent(".subject").find("span").removeClass("selected"),$(".detailFaq").removeClass("selected"),$(".detailFaq").slideUp(),$(".detailFaq"+e).addClass("selected"),$(".detailFaq"+e).parent(".subject").find("span").addClass("selected"),$(".detailFaq"+e).slideDown()),!1)};$(document).ready(function(){0==pageCnbSubType?normalList():account?paginationRendere():$("#custom_main").prepend('<table class="table_list ng-scope"><div class="notice noaccount"><strong>로그인 후 확인하실 수 있습니다.</strong></div></table>')});