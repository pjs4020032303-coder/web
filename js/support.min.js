/*!
 * project : support
 * author : LINOFFICE
 * 후원
 */ var sending_msg=!1;function agree_progres(){if(!account){ncuim_modal_show("로그인 후 이용 가능합니다.");return}$("#agree_check").is(":checked")?getDatas(["/define/support/agree"],e=>{if(e){$(".container").html(e),ncuim_modal_show("약관 동의가 완료되었습니다.");let a=$("#chargeAmt");a&&setInputToComma(a)}},e=>{throw Error("agree_progres support.js Error")}):ncuim_modal_show("약관동의 후 진행할 수 있습니다.")}function support_bank_request(){if(!account){ncuim_modal_show("로그인 후 이용 가능합니다.");return}if(!account.firstChar){ncuim_modal_show("대표 캐릭터를 찾을 수 없습니다.");return}if(!account.ingame){ncuim_modal_show("인게임에서 이용할 수 있습니다.");return}!sending_msg&&(sending_msg=!0,$(".dimmed").css("display","block"),$("#send_delay").css("display","block"),getDatas(["/define/support/request"],e=>{switch($("#send_delay").css("display","none"),e){case 1:ncuim_modal_show("정상적으로 요청 되었습니다.");break;case 2:ncuim_modal_show("인게임에서 이용할 수 있습니다.");break;case 3:ncuim_modal_show("계정 정보를 찾을 수 없습니다.");break;case 4:ncuim_modal_show("대표 캐릭터를 찾을 수 없습니다.");break;case 5:ncuim_modal_show("인게임 내 케릭터를 찾을 수 없습니다.");break;default:ncuim_modal_show("요청에 실패하였습니다.")}sending_msg=!1},e=>{$(".dimmed").css("display","none"),$("#send_delay").css("display","none"),sending_msg=!1,ncuim_modal_show("오류가 발생하였습니다.")}))}function sendGmMessage(){let e=$("#chargeName").val();if(!e||!e.length){ncuim_modal_show("입금자명을 입력하세요.");return}let a=$("#chargeAmt").val();if(!a||!a.length){ncuim_modal_show("입금금액을 입력하세요.");return}if(!account){ncuim_modal_show("로그인 후 이용 가능합니다.");return}if(!account.firstChar){ncuim_modal_show("대표 캐릭터를 찾을 수 없습니다.");return}if(!account.ingame){ncuim_modal_show("인게임에서 이용할 수 있습니다.");return}!sending_msg&&(sending_msg=!0,$(".dimmed").css("display","block"),$("#send_delay").css("display","block"),getDatasWithOption([{type:"POST",url:"/define/support/msg",dataType:"json",contentType:"application/json",Accept:"application/json",data:{chargeName:e,chargeAmt:a}}],e=>{switch($("#send_delay").css("display","none"),e){case 1:$("#support_complete_msg").val(""),ncuim_modal_show("정상적으로 처리되었습니다.");break;case 2:ncuim_modal_show("인게임에서 이용할 수 있습니다.");break;case 3:ncuim_modal_show("계정 정보를 찾을 수 없습니다.");break;case 4:ncuim_modal_show("대표 캐릭터를 찾을 수 없습니다.");break;case 5:ncuim_modal_show("인게임 내 케릭터를 찾을 수 없습니다.");break;case 6:ncuim_modal_show("파라미터가 누락되었습니다.");break;case 7:ncuim_modal_show("정상적으로 데이터가 저장되었으나 텔레그램 보내기에 실패하였습니다.");break;default:ncuim_modal_show("전송에 실패하였습니다.")}sending_msg=!1},e=>{$(".dimmed").css("display","none"),$("#send_delay").css("display","none"),sending_msg=!1,ncuim_modal_show("오류가 발생하였습니다.")}))}class SUPPORT_WEBSOCKET{constructor(){}on_open(e){}on_message(e){let a=e.data;if(-1==a.indexOf("{")){console.log("not found protocol delimiter "+a);return}var r=JSON.parse(a);if(!r){console.log("not found protocol object "+a);return}if(account&&account.name&&r.user_name&&account.name==r.user_name)switch(r.type){case"BANK_RESPONSE":ncuim_modal_show(`입금 계좌 정보</br></br>${r.message}</br></br>완료 후 입금금액 보내기를 진행해주십시오.`);break;case"BANK_PAY_FINISH":ncuim_modal_show(r.message)}}on_close(e){}}function chargeNameResetFade(){""==!$(".charge-name .chargeName").val()?$(".chargeName-reset").fadeIn():$(".chargeName-reset").fadeOut()}function chargeAmtResetFade(){""==!$(".charge-value .chargeAmt").val()?$(".chargeAmt-reset").fadeIn():$(".chargeAmt-reset").fadeOut()}function setChargeAmount(e){var a=$(".charge-value .chargeAmt"),r=NCoinUtils.formatCommas(e);a.val(r),show_unit()}function show_unit(){var e=$(".chargeAmt").val().length,a=48;e>0?(5==e||6==e||7==e?(e-=1,a+=10):e>=9&&(e-=1,a),$(".show-unit").length||$(".charge-value .static .wrapper").append('<p class="show-unit"><span>원</span></p>'),$(".show-unit").css({left:a+11*e})):$(".show-unit").length&&$(".charge-value .static .wrapper .show-unit").remove()}$(function(){$("#agree_checkbox").on("click",function(e){let a=$("#agree_check");a.prop("checked",!a.is(":checked"))}),$("#chargeAmt").on("keydown",function(e){let a=e.keyCode;if(17==a||18==a||!(a>=48&&a<=57||a>=96&&a<=105||8==a||9==a))return!1;var r=$(".charge-value .chargeAmt");setChargeAmount(NCoinUtils.getChargeAmt(r.val()))}),$("#chargeAmt").on("keyup",function(){var e=$(".charge-value .chargeAmt");setChargeAmount(NCoinUtils.getChargeAmt(e.val()))}),$(".charge-value .chargeAmt").on({focus:function(){$(this).parent().addClass("focus")},blur:function(){if(""==$(this).val())return $(this).parent().removeClass("focus"),$(".chargeAmt-reset").fadeOut(),!1;var e=$(".charge-value .chargeAmt");setChargeAmount(NCoinUtils.getChargeAmt(e.val())),chargeAmtResetFade()},keypress:function(){chargeAmtResetFade()}}),$("#chargeName").on("keyup",function(){chargeNameResetFade()}),$(document).on("click",".charge-value .chargeAmt-reset",function(){$(".chargeAmt").val("").focus();var e=$(".charge-value .chargeAmt");setChargeAmount(NCoinUtils.getChargeAmt(e.val())),$(".chargeAmt-reset").fadeOut()}),$(".charge-name .chargeName").on({focus:function(){$(this).parent().addClass("focus")},blur:function(){if(""==$(this).val())return $(this).parent().removeClass("focus"),$(".chargeName-reset").fadeOut(),!1;chargeNameResetFade()},keypress:function(){chargeNameResetFade()}}),$(document).on("click",".charge-name .chargeName-reset",function(){$(".chargeName").val("").focus(),$(".chargeName-reset").fadeOut()}),(ws_handler=new WebSocketHandler(ws_config,new SUPPORT_WEBSOCKET)).connect()});