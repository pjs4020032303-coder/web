/*!
 * project : notice
 * author : LINOFFICE
 * 소식
 */ $(function(){includeHTML(document.querySelector("#svg-container"),"https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/svg.html",cacheVersion);var s=$(".ui-dropdown"),a=$(".ui-dropdown-custom_items"),e=$(".co-btn-reset"),t=$(".btn-list"),o=$(".btn-cards"),i=$(".ncCommunityBoardList"),n=$(".co-btn-top_list"),c=$(".btn-type-selected");s.on("click",function(s){$(this).toggleClass("is-active")}),a.on("click",function(s){$(".ui-dropdown-community.is-active .select").find("span").html($(this).attr("data-textvalue")),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),e.on("click",function(s){$("#ncCommunitySearch").val("")});var l=function(s){$(".co-btn").removeClass("is-disabled"),"card"==s?(t.addClass("is-disabled"),i.hasClass("board-list-default")&&i.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),c.removeClass("list"),c.addClass("card"),c.html("<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>")):(o.addClass("is-disabled"),i.hasClass("board-list-card")&&i.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),c.removeClass("card"),c.addClass("list"),c.html("<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>")),c.removeClass("is-show")};t.on("click",function(s){i.hasClass("board-list-card")&&(l("list"),setLocal("board_notice_viewMode","list"))}),o.on("click",function(s){i.hasClass("board-list-default")&&(l("card"),setLocal("board_notice_viewMode","card"))}),"card"==getLocal("board_notice_viewMode")&&l("card"),n.on("click",function(s){document.body.scrollTop=0,document.documentElement.scrollTop=0,$(".ncPurple .container").animate({scrollTop:0},300)}),c.on("click",function(s){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(s){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(s){$("#wrapSearch").removeClass("is-show")}),$("body").mouseup(function(s){!$(".option").has(s.target).length&&!$(".ui-dropdown.is-active").has(s.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(s.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(s)});var r=$(".nowCheckvalue");r&&r.length&&$.each(r,function(s,a){if(!a.value){var e=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(e)}})});let more_btn_lock=!1;function noticeMore(){if(more_btn_lock||parameter.total_size<=0)return;let s=$(".nc-community-loader");s.css("display",""),more_btn_lock=!0,getDatasWithOption([{type:"POST",url:"/define/notice/more",dataType:"json",contentType:"application/json",Accept:"application/json",data:parameter}],a=>{var e="";$.each(a,function(s,a){e+=createNoticeHtml(a)}),$(e).appendTo(".ncCommunityBoardList"),a.length&&(parameter.current_num+=a.length,parameter.total_size-=a.length,parameter.total_size<=0&&$(".wrap-community-more").html("")),s.css("display","none"),more_btn_lock=!1},a=>{throw s.css("display","none"),more_btn_lock=!1,Error("noticeMore from notice.js Error")})}function createNoticeHtml(s){var a=$(".ncCommunityBoardList"),e="",t="display:none;";a.hasClass("board-list-card")&&(e="display:none;",t="");var o="",i="";switch(s.type){case 1:o="업데이트",i="/update/view";break;case 2:o="이벤트",i="/event/view";break;default:o="공지",i="/notice/view"}let n=`<span class="category">${o}&nbsp</span>`,c='<span class="writer"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/lineage_writer.png" alt=""></span>&nbsp',l=`<span class="date">${moment(new Date(s.date)).format("YY.MM.DD.")}</span>&nbsp`,r=moment().format("YYYYMMDD"),p=moment(new Date(s.date)).format("YYYYMMDD"),d=r-p;return`<li class="board-items" onClick='urlTypeform("${s.type}", "${s.rownum}", "post", "${i}");'><div class="title board-type-list" style="${e}">`+n+`<a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${i}");'>${s.title}</a>`+`${s.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':""}`+`${0===d?'&nbsp<i class="fe-icon-new" data-diff=""></i>':""}`+"</div>"+`<div class="info board-type-list" style="${e}">`+c+l+`<span class="hit"><em class="txt">조회</em>${s.readcount}</span>`+"</div>"+`<div class="board-type-card" style="${t}">`+`${s.mainImg?`<div class="board-items-thumb"><a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${i}");'><img src="${s.mainImg}" alt=""></a></div>`:""}`+'<div class="board-items-contents">'+`<div class="title">${n}<a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${i}");'>${s.title}${0===d?'&nbsp<i class="fe-icon-new"></i></a>':"</a>"}</div>`+`<div class="desc desc-overflow"><a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${i}");'>${s.content}</a></div>`+c+"</div>"+`<div class="board-items-footer"><div class="info"><span class="writer">${s.name}</span>${l}<span class="hit-count"><span class="txt">조회 </span><em>${s.readcount}</em></span></div></div>`+"</div></li>"}function boardFormSubmit(){var s=document.boardWriteForm;if(!account||!account.firstChar){popupShow("로그인 후 등록할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!s.noti_type.value){popupShow("유형을 선택해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!s.title.value){popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!s.content.value){popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!maxByteCheck(s.content.value,1))return;let a={noti_type:s.noti_type.value,title:s.title.value,content:s.content.value,images:Editor.images};s.rownum&&(a.rownum=s.rownum.value),getDatasWithOption([{type:"POST",url:s.action,dataType:"json",contentType:"application/json",Accept:"application/json",data:a}],a=>{if(a)switch(Editor.instance.setSubmit(),s.noti_type.value){case"0":location.href="/notice";break;case"1":location.href="/update";break;case"2":location.href="/event"}else popupShow("등록 또는 수정에 실패 하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},s=>{throw Error("boardFormSubmit from board.js Error")})}function delectNoticeConfirm(s,a){popupShow(`정말로 삭제하시겠습니까?`,`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:deleteNoticeConfirmAction(${s}, ${a});" class="close">예</a></span>`)}function deleteNoticeConfirmAction(s,a){getDatasWithOption([{type:"POST",url:"/define/notice/delete",dataType:"json",contentType:"application/json",Accept:"application/json",data:{type:a,rownum:s}}],s=>{if(s)switch(a){case"0":location.href="/notice";break;case"1":location.href="/update";break;case"2":location.href="/event"}else popupShow("삭제에 실패 하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},s=>{throw Error("deleteNoticeConfirmAction from notice.js Error")})}