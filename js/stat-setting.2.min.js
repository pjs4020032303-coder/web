var $;!function(){"use strict";function n(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var t,r={engine:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};r.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},a=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(a,function(t){return e[t]||t}):""}},t=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):t.doT=r;var o={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;r.template=function(e,i,l){var s,S,c=(i=i||r.templateSettings).append?o.append:o.split,E=0,d=i.use||i.define?function e(i,l,s){return("string"==typeof l?l:l.toString()).replace(i.define||a,function(e,l,S,c){return 0===l.indexOf("def.")&&(l=l.substring(4)),l in s||(":"===S?(i.defineParams&&c.replace(i.defineParams,function(e,i,S){s[l]={arg:i,text:S}}),l in s||(s[l]=c)):Function("def","def['"+l+"']="+c)(s)),""}).replace(i.use||a,function(l,S){i.useParams&&(S=S.replace(i.useParams,function(e,i,l,S){if(s[l]&&s[l].arg&&S){var c=(l+":"+S).replace(/'|\\/g,"_");return s.__exp=s.__exp||{},s.__exp[c]=s[l].text.replace(RegExp("(^|[^\\w$])"+s[l].arg+"([^\\w$])","g"),"$1"+S+"$2"),i+"def.__exp['"+c+"']"}}));var c=Function("def","return "+S)(s);return c?e(i,c,s):c})}(i,e,l||{}):e;d=("var out='"+(i.strip?d.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):d).replace(/'|\\/g,"\\$&").replace(i.interpolate||a,function(e,i){return c.start+n(i)+c.end}).replace(i.encode||a,function(e,i){return s=!0,c.startencode+n(i)+c.end}).replace(i.conditional||a,function(e,i,l){return i?l?"';}else if("+n(l)+"){out+='":"';}else{out+='":l?"';if("+n(l)+"){out+='":"';}out+='"}).replace(i.iterate||a,function(e,i,l,s){return i?(E+=1,S=s||"i"+E,"';var arr"+E+"="+(i=n(i))+";if(arr"+E+"){var "+l+","+S+"=-1,l"+E+"=arr"+E+".length-1;while("+S+"<l"+E+"){"+l+"=arr"+E+"["+S+"+=1];out+='"):"';} } out+='"}).replace(i.evaluate||a,function(e,i){return"';"+n(i)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),s&&(i.selfcontained||!t||t._encodeHTML||(t._encodeHTML=r.encodeHTMLSource(i.doNotSkipEncoded)),d="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+r.encodeHTMLSource.toString()+"("+(i.doNotSkipEncoded||"")+"));"+d);try{return Function(i.varname,d)}catch(p){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+d),p}},r.compile=function(t,e){return r.template(t,null,e)}}();const ALERT={FAIL_RESET:"현재 스탯 초기화를 할 수 없습니다. 잠시 후, 다시 시도해주세요.",FAIL_LOAD_SAVED_STAT:"현재 저장된 스탯 데이터를 가져올 수 없습니다. 잠시 후, 다시 시도해주세요.",CONFIRM_RESET:"초기화를 하면 레벨은 50으로, 입력하신 스탯포인트는 모두 베이스 스탯으로 초기화 됩니다.",CAN_SAVE_STAT_AFTER_LOGIN:"스탯 세팅 저장은 로그인 후 이용 가능합니다.",CAN_MODIFY_STAT_AFTER_LOGIN:"스탯 세팅 수정은 로그인 후 이용 가능합니다.",CAN_DELETE_STAT_AFTER_LOGIN:"스탯 세팅 삭제는 로그인 후 이용 가능합니다.",SAVE_STAT_LIMIT:`스탯 세팅 저장은 계정당 최대 6개까지 가능합니다.
새 세팅 결과 저장을 원한다면 기존 저장 내용 삭제 후 이용해주세요.
스탯 세팅을 계속 진행하시겠습니까?`,TRY_DELETE_STAT:t=>`${t.level}Lv 스탯 세팅을 삭제하시겠습니까?`,FAIL_DELETE_STAT:"현재 스탯 삭제를 할 수 없습니다. 잠시 후, 다시 시도해주세요.",FAIL_SAVE_STAT:"현재 스탯 저장을 할 수 없습니다. 잠시 후, 다시 시도해주세요.",CAN_LEVELUP_AFTER_INIT_BASE_STAT:"베이스 스탯 포인트 분배 후에 레벨업하실 수 있습니다.",CAN_LEVELUP_AFTER_EXHAUST_REMAIN_STAT:"남은 스탯을 모두 사용하셔야 레벨업하실 수 있습니다.",COMPLETE_TARGET_LEVEL:"목표 레벨까지 모두 레벨업하셨습니다.",CAN_PROCESS_AFTER_EXHAUST_ELIXIR_STAT:"엘릭서의 스탯을 모두 사용하셔야 다음 진행을 하실 수 있습니다.",FAIL_CALCULATE_STAT:"현재 스탯 계산을 할 수 없습니다. 잠시 후, 다시 시도해주세요.",COMPLETE_DISTRIBUTE_BASE_STAT:`베이스 스탯을 모두 분배하셨습니다.
이제 레벨업으로 원하는 스탯에
보너스 스탯 포인트를 분배하실 수 있습니다.`,REMAIN_STAT_ZERO:"사용하실 수 있는 스탯 포인트를 모두 사용하셨습니다.",IMPOSSIBLE_LEVEL_CONSUME_ELIXIR_STAT:"엘릭서 스탯 포인트를 사용할 수 없는 레벨입니다.",NO_UNDO_STAT:"되돌릴 수 있는 스탯 포인트가 없습니다.",REQUIRE_EXHAUST_STAT:"남은 스탯 포인트를 모두 배분해주세요.",NEED_STAT_POINT:t=>`스탯을 올리려면 최소 ${t.point}포인트가 필요합니다. 
 레벨을 올려 사용 가능 포인트를 모아주세요.`,STAT_MAX_LIMIT:`선택한 스탯을 더 이상 올릴 수 없습니다.\u2028 레벨을 올려 스탯 한계치를 높여주세요.`,DISABLE_LEVELUP:`포인트가 3 이상이면 레벨업이 불가능합니다. 
 \u2028스탯 상승 버튼을 클릭해 포인트를 소모해주세요.`},BREAKPOINTS={tablet:640,pc:960,max:1340},DAYS={Sunday:"일",Monday:"월",Tuesday:"화",Wednesday:"수",Thursday:"목",Friday:"금",Saturday:"토"},API_DOMAIN_DEFAULT="",API_COMMUNITY_DOMAIN="",STATIC_DOMAIN_DEFAULT="",STATIC_CDN_DOMAIN_DEFAULT="",NO_ITEM_IMAGE_URL="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/noimg.gif",PET_NECKLACE_ID=25668,getLoadingBarTpl=()=>'<div class="loadingbar"></div>',getSectionTpl=()=>`
	  <section class="variation variation__stat">
			<dl class="stat-STR">
				<dt class="STR"> <!-- em1, em2, em3 -->
					<strong>STR</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.STR}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
					<ul>
						<li class="DAMAGE_SHORT"><label>근거리 대미지</label><var>{{=it.DAMAGE_SHORT}}</var></li>
            <li class="HIT_SHORT"><label>근거리 명중</label><var>{{=it.HIT_SHORT}}</var></li>
            <li class="FATAL_SHORT"><label>근거리 치명타</label><var>{{=it.FATAL_SHORT}}</var></li>
            <li class="WEIGHT"><label>최대 소지 무게</label><var>{{=it.WEIGHT}}</var></li>
					</ul>
				</dd>
			</dl>

			<dl class="stat-DEX">
				<dt class="DEX">
					<strong>DEX</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.DEX}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
					<ul>
						<li class="DAMAGE_LONG"><label>원거리 대미지</label><var>{{=it.DAMAGE_LONG}}</var></li>
            <li class="HIT_LONG"><label>원거리 명중</label><var>{{=it.HIT_LONG}}</var></li>
            <li class="FATAL_LONG"><label>원거리 치명타</label><var>{{=it.FATAL_LONG}}</var></li>
            <li class="AC"><label>물리 방어력(AC)</label><var>{{=it.AC}}</var></li>
            <li class="ER"><label>원거리 회피력(ER)</label><var>{{=it.ER}}</var></li>
					</ul>
				</dd>
			</dl>
			
			<dl class="stat-INT">
				<dt class="INT">
					<strong>INT</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.INT}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
					<ul>
						<li class="DAMAGE_WIZ"><label>마법 대미지</label><var>{{=it.DAMAGE_WIZ}}</var></li>
                        <li class="HIT_WIZ"><label>마법적중</label><var>{{=it.HIT_WIZ}}</var></li>
                        <li class="FATAL_WIZ"><label>마법 치명타</label><var>{{=it.FATAL_WIZ}}</var></li>
                        <li class="MB"><label>마법 보너스(MB)</label><var>{{=it.MB}}</var></li>
                        <li class="MP_MINUS"><label>MP 소모 감소</label><var>{{=it.MP_MINUS}}</var></li>
					</ul>
				</dd>
			</dl>
			
			<dl class="stat-WIS">
				<dt class="WIS">
					<strong>WIS</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.WIS}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
					<ul>
						<li class="LEVELUP_MP_PLUS"><label>레벨업시 MP 증가</label><var>{{=it.LEVELUP_MP_PLUS_MIN}} ~ {{=it.LEVELUP_MP_PLUS_MAX}}</var></li>
                        <li class="MP_RECOVER_TIC"><label>MP 회복(틱)</label><var>{{=it.MP_RECOVER_TIC}}</var></li>
                        <li class="MP_RECOVER_LIQUOR"><label>MP 물약 회복(틱)</label><var>{{=it.MP_RECOVER_LIQUOR}}</var></li>
                        <li class="MR"><label>마법 방어력(MR)</label><var>{{=it.MR}}</var></li>
					</ul>
				
				
				</dd>
			</dl>

			<dl class="stat-CON">
				<dt class="CON">
					<strong>CON</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.CON}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
					<ul>
						<li class="HP_PLUS"><label>레벨업시 HP 증가</label><var>{{=it.LEVELUP_HP_PLUS_MIN}} ~ {{=it.LEVELUP_HP_PLUS_MAX}}</var></li>
                        <li class="HP_RECOVER_TIC"><label>HP 회복(틱)</label><var>{{=it.HP_RECOVER_TIC_MIN}} ~ {{=it.HP_RECOVER_TIC_MAX}}</var></li>
                        <li class="HP_RECOVER_LIQUOR"><label>HP 물약 회복 증가</label><var>{{=it.HP_RECOVER_LIQUOR}}</var></li>
                        <li class="WEIGHT"><label>최대 소지 무게</label><var>{{=it.WEIGHT}}</var></li>
                        <li class="CON_DAMAGE_MINUS"><label>대미지 감소</label><var>{{=it.CON_DAMAGE_MINUS}}</var></li>
                        <li class="CON_RES_SKILL"><label>기술 내성</label><var>{{=it.CON_RES_SKILL}}</var></li>
                        <li class="CON_RES_SUMMON"><label>정령 내성</label><var>{{=it.CON_RES_SUMMON}}</var></li>
                        <li class="CON_RES_DRAGON"><label>용언 내성</label><var>{{=it.CON_RES_DRAGON}}</var></li>
                        <li class="CON_RES_FEAR"><label>공포 내성</label><var>{{=it.CON_RES_FEAR}}</var></li>
					</ul>
				</dd>
			</dl>

			<dl class="stat-CHA">
				<dt class="CHA">
					<strong>CHA</strong>
					<span class="util">
						{{? it.page === "default" || it.page === 'modify' }}<button class="down">-</button>{{?}}
						<var>{{=it.CHA}}</var>
						{{? it.page === "default" || it.page === 'modify' }}<button class="up">+</button>{{?}}
					</span>
				</dt>
				<dd>
                  <ul>
                    <li class="CHA_HIT_SIKII"><label>기술 적중</label><var>{{=it.CHA_HIT_SIKII}}</var></li>
                    <li class="CHA_HIT_SUMMON"><label>정령 적중</label><var>{{=it.CHA_HIT_SUMMON}}</var></li>
                    <li class="CHA_HIT_DRAGON"><label>용언 적중</label><var>{{=it.CHA_HIT_DRAGON}}</var></li>
                    <li class="CHA_HIT_FEAR"><label>공포 적중</label><var>{{=it.CHA_HIT_FEAR}}</var></li>
                    <li class="CHA_SKILL_TIME_REDUCTION"><label>스킬 쿨타임 감소</label><var>{{=it.CHA_SKILL_TIME_REDUCTION}}</var></li>
                    <li class="CHA_STATUS_TIME_REDUCTION"><label>상태 이상 시간 감소</label><var>{{=it.CHA_STATUS_TIME_REDUCTION}}</var></li>
                  </ul>
                </dd>
			</dl>
	  </section>`,getStatSimulatorTpl=()=>`<section class="simulator__stat" tabindex="0">
    <header>
      <span class="icon-back" title="뒤로"></span>
      <h3></h3>
        <div class="util"></div>
    </header>

    <section class="char char__stat">
      <div class="base">
        <img src="{{=it.classImageUrl}}" class="thumb" />
        <span class="name"></span>
        <span class="server"></span>
        <span class="level"><strong>{{=it.level}}</strong>Lv.</span>
        <span class="level_target"><strong>{{=it.targetLevel}}</strong>Lv.</span>
      </div>

      {{? it.page === "default" || it.page === 'modify' }}
      <div class="wrap-button">
        <button class="button btn-levelup">레벨 UP</button>
        <div class="tooltip-levelup"></div>
      </div>

      <div class="point">
        <p class="statPoint"><label>사용 가능 포인트</label><var><strong class="remainStatPoint">{{=it.remainStatPoint}}</strong><!--<span class="totalStatPoint">{{=it.totalStatPoint}}</span>--></var></p>
        <p class="elixirPoint"><!--<span class="custom-checkbox"><input type="checkbox" name="ELIXIR_POINT" id="ELIXIR_POINT" value=""></span>--><label>/ 엘릭서</label><var>(<strong class="remainElixirPoint">{{=it.remainElixirPoint}}</strong>)<!--<span class="totalElixirPoint">{{=it.totalElixirPoint}}</span>--></var></p>
      </div>
      {{?}}

      <div class="hpmp">
        <ul>
          <li class="hp">
            <label>HP</label>
            <span class="graph"><figure style="width:100%"></figure></span>
            <var>{{=it.HP}}</var>
          </li>

          <li class="mp">
            <label>MP</label>
            <span class="graph"><figure style="width:100%"></figure></span>
            <var>{{=it.MP}}</var>
          </li>
        </ul>
      </div>
    </section>

    ${getSectionTpl()}

    {{? it.page === "default" || it.page === 'modify' }}
    <footer>
      <p>PC에서는 키보드의 [V] 버튼으로 간편하게 레벨업 할 수 있습니다.</p>
      <p>사용 가능 포인트를 소모하여 스탯을 올릴 수 있습니다.</p>
      <p>레벨이 오르면 사용 가능 포인트가 증가하며, 입력한 엘릭서는 일정 레벨마다 포인트에 포함됩니다.</p>
    </footer>
    {{?}}
  </section>`,getStatStorageItemTpl=(t=!1)=>{let e=!0===t?'<button class="btn-delete" title="delete"></button>':"";return`<article class="storage__stat" data-idx="{{=it.idx}}" data-class-id="{{=it.classId}}" data-level="{{=it.level}}" data-target-level="{{=it.targetLevel}}" data-hp="{{=it.hp}}" data-mp="{{=it.mp}}" >
    <div class="char">
      <img src="{{=it.classImageUrl}}" class="thumb">
      <span class="name"></span>
      <span class="server"></span>
      <span class="level">{{=it.level}}Lv.</span>
      <span class="date">{{=it.date}}</span>
    </div>

    <div class="stat">
      <ul>
        <li class="stat-STR">
          <label>STR</label>
          <span class="graph"><figure style="width:{{=it.percentageSTR}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.STR}}</var>
        </li>
        <li class="stat-DEX">
          <label>DEX</label>
          <span class="graph"><figure style="width:{{=it.percentageDEX}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.DEX}}</var>
        </li>
        <li class="stat-INT">
          <label>INT</label>
          <span class="graph"><figure style="width:{{=it.percentageINT}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.INT}}</var>
        </li>
        <li class="stat-WIS">
          <label>WIS</label>
          <span class="graph"><figure style="width:{{=it.percentageWIS}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.WIS}}</var>
        </li>
        <li class="stat-CON">
          <label>CON</label>
          <span class="graph"><figure style="width:{{=it.percentageCON}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.CON}}</var>
        </li>
        <li class="stat-CHA">
          <label>CHA</label>
          <span class="graph"><figure style="width:{{=it.percentageCHA}}"></figure></span>
          <var>{{=it.statMetaInfo.mainStat.CHA}}</var>
        </li>
      </ul>
    </div>

    ${e}
  </article>`};let handleApiError=function(t,e=window){return!!t&&401===parseInt(t.status,10)&&(e.alert(ALERT.REQUIRE_LOGIN),"function"==typeof e.GNBLogin)&&(e.GNBLogin(),!0)},getChangedStats=function(t,e){var a,i;let l={};for(let n in t)a=isDefined(t[n])?t[n]:null,i=isDefined(e[n])?e[n]:null,allOf(isDefined(i),a!==i)&&(l[n]=i);let o=0;for(let s in l)o++;return o>0?l:null},getPlusElixirPointByLevel=function(t,e,a){let i=0;return(t-e)%2==0&&(i=1),each(a,e=>{parseInt(e.level)===parseInt(t)&&(i=parseInt(e.point))}),i},isLevelCanConsumeElixirStat=function(t,e){return t>=0},isLevelGetElixirPoint=function(t,e){return t%e==0},isWarrior=function(t){return 7===parseInt10(t)},getClassName=function(t){let e=["군주","기사","요정","마법사","다크엘프","용기사","환술사","전사","검사","창기사","성기사","투사"][parseInt10(t)];return not(isDefined)(e)&&(e=""),e},removeEquipInEquips=function(t,e){if(!Array.isArray(t))throw TypeError("arr parameter type of removeEquipInEquips() must be Array.");let a=t.slice(),i;for(let l=0,n=a.length;l<n;l++)if(allOf(isDefined(i=a[l]),i.id===e.id,i.name===e.name,i.slot===e.slot)){a.splice(l,1);break}return a};const isPetNecklace=function(t){return 25668===t};let minNumber=function(t,e){return t<e?t:e};const getElixirByLevel=function(){let t=[],e=0;for(let a=50;a<=110;a++){let i=0;a>=50&&a<=78&&a%2==0?i=1:80===a?i=2:a>=82&&a<=88&&a%2==0?i=1:90===a?i=2:a>=91&&a<=97?i=1:a>=98&&a<=110&&(i=2),e+=i,t[a]=e}return t},getElixirIncrease=function(t){let e=getElixirByLevel(),a=e[Number(t)-1]||0,i=e[Number(t)]||0;return i-a},getStatMaxByLevel=function(t){return t<90?50:t>=90&&t<95?55:t>=95&&t<98?60:t>=98&&t<99?65:t>=99&&t<100?70:75},getCostPointByStat=function(t,e){return"plus"===e?t>=1&&t<=55?1:t>=56&&t<=65?2:t>=66&&t<=75?3:1:t>=1&&t<=56?1:t>=57&&t<=66?2:t>=67&&t<=76?3:1},singletonLoadingId=Symbol(),singletonLoadingEnforcer=Symbol();class SingletonLoading{constructor(t){if(t!==singletonLoadingEnforcer)throw Error("SingletonLoading can not use construct.");this.loadingBar=null,this._isLoading=!1}static getInstance(){return this[singletonLoadingId]||(this[singletonLoadingId]=new SingletonLoading(singletonLoadingEnforcer)),this[singletonLoadingId]}setLoadingBar(t){return this.loadingBar=$(t),this}start(){let t=this;return t.loadingBar.show(),t._isLoading=!0,console.log("loading start"),t}end(){let t=this;return t.loadingBar.hide(),t._isLoading=!1,console.log("loading end"),t}get isLoading(){return this._isLoading}}let getSavedUserStats=function(t={apiDomain:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/stat/user`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getSavedUserStats error");l.jqXHR=t,a(l)})})},getClassDefaultStat=function(t={apiDomain:"",classId:"",targetLevel:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/stat/${t.classId}/default?targetLevel=${t.targetLevel}`,contentType:"application/json",dataType:"json",beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getClassDefaultStat error");l.jqXHR=t,a(l)})})},getSavedUserStat=function(t={apiDomain:"",idx:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/stat/user/${t.idx}`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getSavedUserStat error");l.jqXHR=t,a(l)})})},saveNewUserStat=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"POST",url:`${t.apiDomain}/web/simulator/stat/user`,contentType:"application/json",dataType:"json",data:JSON.stringify(t.sendData),xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("saveNewUserStat error");l.jqXHR=t,a(l)})})},saveUserStat=function(t={apiDomain:"",idx:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/stat/user/${t.idx}`,contentType:"application/json",dataType:"json",data:JSON.stringify(t.sendData),xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("saveUserStat error");l.jqXHR=t,a(l)})})},deleteUserStat=function(t={apiDomain:"",idx:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"DELETE",url:`${t.apiDomain}/web/simulator/stat/user/${t.idx}`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("deleteUserStat error");l.jqXHR=t,a(l)})})},calculateStatByLevelUp=function(t={apiDomain:"",classId:"",level:1,sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/stat/class/${t.classId}/level/${t.level}`,data:JSON.stringify(t.sendData),contentType:"application/json",dataType:"json",beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("calculateStatByLevelUp error");l.jqXHR=t,a(l)})})},calculateStat=function(t={apiDomain:"",classId:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/stat/class/${t.classId}`,data:JSON.stringify(t.sendData),contentType:"application/json",dataType:"json",beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("calculateStat error");l.jqXHR=t,a(l)})})},getStatNoEquips=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/equip/class/${t.sendData.classId}/final_stats`,contentType:"application/json",data:JSON.stringify(t.sendData),dataType:"json",cache:!1,xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getStatNoEquips error");l.jqXHR=t,a(l)})})},getMyCharacters=function(t={apiDomain:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/api/my/characters`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getMyCharacters error");l.jqXHR=t,a(l)})})},getSavedUserEquips=function(t={apiDomain:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/user`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},cache:!1,beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getSavedUserEquips error");l.jqXHR=t,a(l)})})},getSavedUserEquip=function(t={apiDomain:"",idx:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/user/${t.idx}`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getSavedUserEquip error");l.jqXHR=t,a(l)})})},getUserStats=function(t={apiDomain:"",serverId:"",characterName:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/servers/${t.serverId}/characters/${t.characterName}/stat`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getUserStats error");l.jqXHR=t,a(l)})})},getUserSlotsStatus=function(t={apiDomain:"",serverId:"",characterName:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/servers/${t.serverId}/characters/${t.characterName}/slot`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getUserSlotsStatus error");l.jqXHR=t,a(l)})})},getUserEquips=function(t={apiDomain:"",serverId:"",characterName:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/servers/${t.serverId}/characters/${t.characterName}/equipments`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getUserEquips error");l.jqXHR=t,a(l)})})},getSearchEquipItems=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.searchApiDomain}/lineage/search/v2/equip`,contentType:"application/json",data:t.sendData,dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getSearchEquipItems() error");l.jqXHR=t,a(l)})})},getStatReflectEquips=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/equip/class/${t.sendData.classId}/item`,contentType:"application/json",data:JSON.stringify(t.sendData),dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getStatReflectEquips error");l.jqXHR=t,a(l)})})},saveNewEquip=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"POST",url:`${t.apiDomain}/web/simulator/equip/user`,contentType:"application/json",data:JSON.stringify(t.sendData),dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("saveNewEquip error");l.jqXHR=t,a(l)})})},saveExistingEquip=function(t={apiDomain:"",idx:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"PUT",url:`${t.apiDomain}/web/simulator/equip/user/${t.idx}`,contentType:"application/json",data:JSON.stringify(t.sendData),dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("saveExistingEquip error");l.jqXHR=t,a(l)})})},deleteSavedEquip=function(t={apiDomain:"",idx:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"DELETE",url:`${t.apiDomain}/web/simulator/equip/user/${t.idx}`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("deleteSavedEquip error");l.jqXHR=t,a(l)})})},getEquipItemPrice=function(t={apiDomain:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/api/marketprice/trade/currentStatisticSummary`,contentType:"application/json",dataType:"json",data:t.sendData,xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getEquipItemPrice error");l.jqXHR=t,a(l)})})},getItemStatisticSummary=function(t={apiDomain:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/api/marketprice/trade/currentStatisticSummary`,contentType:"application/json",dataType:"json",data:t.sendData,xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getItemStatisticSummary error");l.jqXHR=t,a(l)})})},getAffectStats=function(t={apiDomain:"",itemId:"",enchant:"",sendData:null,beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/web/simulator/equip/items/${t.itemId}/enchant/${t.enchant}/affectStats`,contentType:"application/json",dataType:"json",data:t.sendData,xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getAffectStats error");l.jqXHR=t,a(l)})})},getStatArticleDetails=function(t={apiDomain:"",articleId:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/board/simulator/stat/article/${t.articleId}/details`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getStatArticleDetails error");l.jqXHR=t,a(l)})})},getEquipArticleDetails=function(t={apiDomain:"",articleId:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/board/simulator/equip/article/${t.articleId}/details`,contentType:"application/json",dataType:"json",xhrFields:{withCredentials:!0},beforeSend:t.beforeSend||null}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getEquipArticleDetails error");l.jqXHR=t,a(l)})})},getCommunityCategory=function(t={apiDomain:"",beforeSend:null}){return new Promise(function(e,a){$.ajax({type:"GET",url:`${t.apiDomain}/board/simulator/category.json`,contentType:"application/json",dataType:"json"}).done(function(t,a,i){e(t,a,i)}).fail(function(t,e,i){let l=Error("getCommunityCategory error");l.jqXHR=t,a(l)})})},_orgStats={},setOrgStats=function(t={data:null}){return _orgStats=t.data},getOrgStats=function(){return _orgStats};class TopBar{constructor(t){let e=this;e.option=$.extend({page:"default",wrap:null,global:window},t),e.wrap=null,e.global=e.option.global}init(){let t=this;return t.wrap=$(t.option.wrap),t.setInstance(),t}setInstance(){this.setBtns()}setBtns(){let t=this,e=$(t);$(".icon-back",t.wrap).on("click",function(t){t.preventDefault(),e.trigger({type:TopBar.EVT_CLOSE})}),anyOf("default"===t.option.page,"modify"===t.option.page)?($(".util .btn-save",t.wrap).on("click",function(t){t.preventDefault(),e.trigger({type:TopBar.EVT_SAVE})}),$(".util .btn-reset",t.wrap).on("click",function(a){a.preventDefault(),e.trigger({type:TopBar.EVT_TRY_RESET});let i=t.global.confirm(ALERT.CONFIRM_RESET);truthy(i)&&e.trigger({type:TopBar.EVT_RESET})})):"view"===t.option.page&&($(".util .btn-modify",t.wrap).on("click",function(t){t.preventDefault(),e.trigger({type:TopBar.EVT_MODIFY})}),$(".util .btn-delete",t.wrap).on("click",function(t){t.preventDefault(),e.trigger({type:TopBar.EVT_DELETE})}))}destroy(t=null){$(".icon-back",this.wrap).off("click"),$(".util .btn-save",this.wrap).off("click"),$(".util .btn-reset",this.wrap).off("click"),$(".util .btn-modify",this.wrap).off("click"),$(".util .btn-delete",this.wrap).off("click")}}TopBar.EVT_CLOSE="EVT_CLOSE",TopBar.EVT_SAVE="EVT_SAVE",TopBar.EVT_TRY_RESET="EVT_TRY_RESET",TopBar.EVT_RESET="EVT_RESET",TopBar.EVT_MODIFY="EVT_MODIFY",TopBar.EVT_DELETE="EVT_DELETE";class Header{constructor(t){let e=this;e.option=$.extend({wrap:null,data:null,model:null,global:window},t),e.data=e.option.data,e.model=StatModel.getInstance(),e.wrap=null,e.levelField=null,e.remainStatPointField=null,e.totalStatPointField=null,e.remainElixirPointField=null,e.totalElixirPointField=null,e.targetElixirField=null,e.statusElixirStatCheckBox=null,e.elixirStatCheckBox=null,e.levelUpBtn=null,e.tooltipIntroduceShortcut=null,e.isShowedTooltipIntroduceShortcut=!1,e.global=e.option.global}init(){let t=this;return t.wrap=$(t.option.wrap),t.levelField=$(".level > strong",t.wrap),t.remainStatPointField=$(".point .statPoint .remainStatPoint",t.wrap),t.totalStatPointField=$(".point .statPoint .totalStatPoint",t.wrap),t.remainElixirPointField=$(".point .elixirPoint .remainElixirPoint",t.wrap),t.totalElixirPointField=$(".point .elixirPoint .totalElixirPoint",t.wrap),t.elixirStatCheckBox=$("#ELIXIR_POINT",t.wrap),t.statusElixirStatCheckBox=!1,t.levelUpBtn=$(".btn-levelup",t.wrap),t.tooltipIntroduceShortcut=$(".tooltip-levelup",t.wrap),t.setInstance(),t}setInstance(){isDefined(this.data)&&(isDefined(this.data.level)&&this.setLevel(this.data.level),allOf(isBoolean(this.data.elixirUseYN),truthy(this.data.elixirUseYN))?this.setElixirStatCheckBoxChecked(!0):this.setElixirStatCheckBoxChecked(!1),anyOf(parseInt10(this.data.remainStatPoint)>0,0>=parseInt10(this.data.totalStatPoint))&&this.setLevelUpBtnUsable(!1),parseInt10(this.data.level)>=parseInt10(this.data.targetLevel)&&this.setLevelUpBtnUsable(!1)),this.setBtns(),this.setElixirStatCheckBoxEvent(),"mobile"===this.model.DEVICE_TYPE&&this.showTooltipOnlyOnce(!1)}showTooltipOnlyOnce(t){let e=this;if(truthy(t)){if(truthy(e.isShowedTooltipIntroduceShortcut))return;e.isShowedTooltipIntroduceShortcut=!0,e.tooltipIntroduceShortcut.show()}else e.tooltipIntroduceShortcut.hide()}setBtns(){let t=$(this);this.levelUpBtn.on("click",function(e){e.preventDefault(),t.trigger({type:Header.EVT_LEVEL_UP})})}setElixirStatCheckBoxEvent(){let t=this,e=$(t);t.elixirStatCheckBox.on("change",function(a){truthy(t.isCheckedElixirStatCheckBox())?t.setElixirStatCheckBoxChecked(!0):t.setElixirStatCheckBoxChecked(!1),e.trigger({type:Header.EVT_CHECK_ELIXIR_CHECKBOX})})}activedElixirStatCheckBox(){let t=$(this);this.setElixirStatCheckBoxChecked(!0),t.trigger({type:Header.EVT_CHECK_ELIXIR_CHECKBOX})}setLevel(t){this.levelField.text(t)}setHpMp(t){if(isDefined(t.HP)){let e=0>=parseStrIntToInt(t.HP)?"-":t.HP;$(".hp var",this.wrap).text(e)}if(isDefined(t.MP)){let a=0>=parseStrIntToInt(t.MP)?"-":t.MP;$(".mp var",this.wrap).text(a)}}setRemainStatPoint(t){this.remainStatPointField.text(t)}setTotalStatPoint(t){this.totalStatPointField.text(t)}setRemainElixirPoint(t){this.remainElixirPointField.text(t)}setTotalElixirPoint(t){this.totalElixirPointField.text(t)}setAllStats(t={}){this.setRemainStatPoint(t.remainStatPoint),this.setTotalStatPoint(t.totalStatPoint),this.setRemainElixirPoint(t.remainElixirPoint),this.setTotalElixirPoint(t.totalElixirPoint)}activateElixirStatField(t){this.remainElixirPointField.length<=0||(truthy(t)?this.remainElixirPointField.addClass("on"):this.remainElixirPointField.removeClass("on"))}setElixirStatCheckBoxChecked(t){let e=this;$(".custom-checkbox",e.wrap),truthy(t)?e.statusElixirStatCheckBox=!0:e.statusElixirStatCheckBox=!1}setLevelUpBtnUsable(t,e){this.levelUpBtn.length<=0||(truthy(t)?this.levelUpBtn.attr("disabled",!1).addClass("on"):this.levelUpBtn.attr("disabled",!0).removeClass("on"),"pc"===e&&this.showTooltipOnlyOnce(t))}reset(t={}){isDefined(t.level)&&this.setLevel(t.level),truthy(t.elixirUseYN)?this.setElixirStatCheckBoxChecked(!0):this.setElixirStatCheckBoxChecked(!1),this.setAllStats(t)}isCheckedElixirStatCheckBox(){return this.statusElixirStatCheckBox}isUsableLevelUpBtn(){return!this.levelUpBtn.prop("disabled")}destroy(t=null){this.levelUpBtn.off("click"),this.elixirStatCheckBox.off("change")}}Header.EVT_LEVEL_UP="EVT_LEVEL_UP",Header.EVT_CHECK_ELIXIR_CHECKBOX="EVT_CHECK_ELIXIR_CHECKBOX";class Section{constructor(t){let e=this;e.option=$.extend({wrap:null,model:null},t),e.wrap=null,e.model=StatModel.getInstance()}init(t=null){let e=this;return e.wrap=$(e.option.wrap),e.setInstance(),e}setInstance(){this.setUpDownBtns(),this.activateAllMinusBtns(!1),this.activateAllPlusBtns(!1)}setUpDownBtns(){var t=$(this);$(".stat-STR button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"STR"})}),$(".stat-DEX button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"DEX"})}),$(".stat-INT button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"INT"})}),$(".stat-CON button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"CON"})}),$(".stat-WIS button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"WIS"})}),$(".stat-CHA button.up",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_PLUS_STAT,statName:"CHA"})}),$(".stat-STR button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"STR"})}),$(".stat-DEX button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"DEX"})}),$(".stat-INT button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"INT"})}),$(".stat-CON button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"CON"})}),$(".stat-WIS button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"WIS"})}),$(".stat-CHA button.down",this.wrap).on("click",function(e){e.preventDefault(),t.trigger({type:Section.EVT_MINUS_STAT,statName:"CHA"})})}removeUpDownBtnsEventHandler(){$(".stat-STR button",this.wrap).off("click"),$(".stat-DEX button",this.wrap).off("click"),$(".stat-INT button",this.wrap).off("click"),$(".stat-CON button",this.wrap).off("click"),$(".stat-WIS button",this.wrap).off("click"),$(".stat-CHA button",this.wrap).off("click")}setBtnUsable(t,e){anyOf(not(isDefined)(t),t.length<0)||(truthy(e)?t.attr("disabled",!1).addClass("on"):t.attr("disabled",!0).removeClass("on"))}activateAllMinusBtns(t){for(var e=$("button.down",this.wrap),a=0,i=e.length;a<i;a++)this.setBtnUsable($(e.get(a)),t)}activateAllPlusBtns(t){for(var e=$("button.up",this.wrap),a=0,i=e.length;a<i;a++)this.setBtnUsable($(e.get(a)),t)}activatePlusBtn(t,e){var a=$("."+t+" button.up",this.wrap);this.setBtnUsable(a,e)}activateMinusBtn(t,e){var a=$("."+t+" button.down",this.wrap);this.setBtnUsable(a,e)}setChangedStat(t,e,a,i,l=null){for(let n in e){if(not(isDefined)(e[n]))continue;let o=$(`.${n}`,this.wrap);o.length>0&&(truthy(t)?"STR"===n||"INT"===n||"DEX"===n||"WIS"===n||"CON"===n||"CHA"===n?o.addClass("on"):o.addClass("em1").addClass("em2"):"STR"===n||"INT"===n||"DEX"===n||"WIS"===n||"CON"===n||"CHA"===n?o.addClass("on"):o.addClass("em1"),$(`.${n} var`,this.wrap).text(e[n]))}if(this.setChangedRangeField(t,$(".LEVELUP_MP_PLUS",this.wrap),e.LEVELUP_MP_PLUS_MIN,e.LEVELUP_MP_PLUS_MAX,a.LEVELUP_MP_PLUS_MIN,a.LEVELUP_MP_PLUS_MAX),this.setChangedRangeField(t,$(".HP_PLUS",this.wrap),e.LEVELUP_HP_PLUS_MIN,e.LEVELUP_HP_PLUS_MAX,a.LEVELUP_HP_PLUS_MIN,a.LEVELUP_HP_PLUS_MAX),this.setChangedRangeField(t,$(".HP_RECOVER_TIC",this.wrap),e.HP_RECOVER_TIC_MIN,e.HP_RECOVER_TIC_MAX,a.HP_RECOVER_TIC_MIN,a.HP_RECOVER_TIC_MAX),isDefined(i)){console.log("statsFirstAtLevel :",i);let s,r;for(let S in e)s=e[S],r=$(`.${S}`,this.wrap),!anyOf(not(isDefined)(s),r.length<=0)&&(truthy(t)?(s===i[S]&&r.removeClass("em2"),isDefined(l)&&s===l[S]&&r.removeClass("on").removeClass("em1")):s===i[S]&&r.removeClass("on").removeClass("em1"));this.setChangedRangeFieldCompareStatFirstAtLevel(t,$(".LEVELUP_MP_PLUS",this.wrap),"LEVELUP_MP_PLUS_MIN","LEVELUP_MP_PLUS_MAX",e,a,i,l),this.setChangedRangeFieldCompareStatFirstAtLevel(t,$(".HP_PLUS",this.wrap),"LEVELUP_HP_PLUS_MIN","LEVELUP_HP_PLUS_MAX",e,a,i,l),this.setChangedRangeFieldCompareStatFirstAtLevel(t,$(".HP_RECOVER_TIC",this.wrap),"HP_RECOVER_TIC_MIN","HP_RECOVER_TIC_MAX",e,a,i,l)}}setChangedRangeFieldCompareStatFirstAtLevel(t,e,a,i,l,n,o,s=null){if(anyOf(isDefined(l[a]),isDefined(l[i]))){let r=parseStrIntToInt(n[a]),S=parseStrIntToInt(n[i]);truthy(t)?(allOf(r===parseStrIntToInt(o[a]),S===parseStrIntToInt(o[i]))&&e.removeClass("em2"),isDefined(s)&&allOf(r===parseStrIntToInt(s[a]),S===parseStrIntToInt(s[i]))&&e.removeClass("em1")):allOf(r===parseStrIntToInt(o[a]),S===parseStrIntToInt(o[i]))&&e.removeClass("em1")}}setChangedRangeField(t,e,a,i,l,n){anyOf(isDefined(a),isDefined(i))&&!(e.length<=0)&&(truthy(t)?e.addClass("em1").addClass("em2"):e.addClass("em1"),$("var",e).text(l+" ~ "+n))}setStatValueColor(t){let e=[$(".STR",this.wrap),$(".INT",this.wrap),$(".DEX",this.wrap),$(".WIS",this.wrap),$(".CON",this.wrap),$(".CHA",this.wrap)],a=t<this.model.LEVEL_CHANGE_STAT_MAX?this.model.STAT_LEVEL_COLORS:this.model.CHANGED_LEVEL_COLORS,i=null,l=0;for(let n=0,o=e.length;n<o;n++){l=parseInt10($("var",i=e[n]).text()),each(a,t=>{i.removeClass(t.class)});let s="";each(a,t=>{t.level<=l&&(""!==s&&i.removeClass(s),s=t.class,i.addClass(s))})}}setHighlightChangedStats(t){let e=null;for(let a in t)not(isDefined)(t[a])||(e=$(`.${a}`,this.wrap),"STR"===a||"INT"===a||"DEX"===a||"WIS"===a||"CON"===a||"CHA"===a?e.addClass("on"):e.addClass("em1"));this.setHighlightRangedField($(".HP_PLUS",this.wrap),t.LEVELUP_HP_PLUS_MIN,t.LEVELUP_HP_PLUS_MAX),this.setHighlightRangedField($(".HP_RECOVER_TIC",this.wrap),t.HP_RECOVER_TIC_MIN,t.HP_RECOVER_TIC_MAX),this.setHighlightRangedField($(".LEVELUP_MP_PLUS",this.wrap),t.LEVELUP_MP_PLUS_MIN,t.LEVELUP_MP_PLUS_MAX)}setHighlightRangedField(t,e,a){anyOf(isDefined(e),isDefined(a))&&t.length>0&&t.addClass("em1")}reset(t){let e=this;e.removeUpDownBtnsEventHandler();let a=doT.template(getSectionTpl());e.wrap.replaceWith(a(t)),e.wrap=$(".variation.variation__stat"),e.setUpDownBtns()}destroy(t=null){this.removeUpDownBtnsEventHandler()}}Section.EVT_PLUS_STAT="EVT_PLUS_STAT",Section.EVT_MINUS_STAT="EVT_MINUS_STAT";class StatSimulator{constructor(t){let e=this;if(not(isDefined)(t))throw Error("StatSimulator constructor require options object");e.option=$.extend({staticDomain:"",apiDomain:"",classId:"0",page:"default",wrap:null,data:null,classDefaultStatData:null,isLogin:!1,savedUserStatNum:0,useHighlightForDiff:!0,global:window},t),e.model=StatModel.getInstance(),e.loading=SingletonLoading.getInstance(),e.wrap=null,e.topBar=null,e.header=null,e.section=null,e.data=e.option.data,e.statData=null,e.statDataFirstAtLevel=null,e.defaultStatsForDiff=null,e.consumedPoint=0,e.lastConsumedStatName="",e.isUsedElixirAtCurrentLevel=!1,e.isCompleteSetBaseStat=!1,e.global=e.option.global,e.elixirByLevel=getElixirByLevel()}init(t=null){let e=this;if(e.wrap=$(e.option.wrap),notSingleEle(e.wrap))throw Error("wrap must be single element.");switch(e.option.page){case"default":e.statData=StatModel.getDefaultStatData(e.data,{page:e.option.page,type:e.model.DEVICE_TYPE,classType:e.option.classId,level:e.model.LEVEL_INIT,targetElixir:e.option.targetElixir}),console.log("=> init() / default page 시작 / _.option, _.data, _.statData : ",e.option,e.data,e.statData),e.statDataFirstAtLevel=$.extend({},e.statData),e.defaultStatsForDiff=$.extend({},e.statData),e.isCompleteSetBaseStat=!1,e.setInstance({page:"default"});break;case"view":e.statData=e.data,console.log("=> init()  > view 시작 : ",e.data,e.statData),e.statDataFirstAtLevel=$.extend({},e.statData),e.defaultStatsForDiff=StatModel.getDefaultStatData(e.option.classDefaultStatData,{page:e.option.page,type:e.model.DEVICE_TYPE,classType:e.option.classId,level:e.model.LEVEL_INIT,targetLevel:e.option.targetLevel,remainStatPoint:e.option.data.remainStatPoint,remainElixirPoint:e.option.data.remainElixirPoint,totalElixirPoint:e.option.data.totalElixirPoint}),e.isCompleteSetBaseStat=!0,e.setInstance({page:"view"});break;case"modify":e.statData=$.extend(e.data,{page:e.option.page}),console.log("=> init()  >  modify 시작 / _.option, _.data , _.statData  : ",e.option,e.data,e.statData),e.statDataFirstAtLevel=$.extend({},e.statData),e.defaultStatsForDiff=StatModel.getDefaultStatData(e.option.classDefaultStatData,{page:e.option.page,type:e.model.DEVICE_TYPE,classType:e.option.classId,level:e.model.LEVEL_INIT,targetLevel:e.model.LEVEL_MAX,remainStatPoint:e.option.data.remainStatPoint,totalStatPoint:e.option.data.totalStatPoint,remainElixirPoint:parseInt10(e.option.data.remainElixirPoint),totalElixirPoint:e.option.data.totalElixirPoint}),e.isCompleteSetBaseStat=!0,e.setInstance({page:"modify"})}return e}setInstance(t={page:""}){let e=this;e.destroyContents(),e.wrap.empty();let a=doT.template(getStatSimulatorTpl()),i="",l=null;switch(t.page){case"default":console.log("=> 1. setInstance() default page _.statData : ",e.statData),i=a($.extend(e.statData,{page:e.option.page,level:e.option.level,targetLevel:e.option.targetLevel,remainElixirPoint:e.option.remainElixirPoint,totalElixirPoint:e.option.totalElixirPoint,classImageUrl:`${e.option.staticDomain}/resource/lineage/profile/char${e.option.classId}_m.png`})),e.wrap.append(i),e.topBar=new TopBar({page:e.option.page,wrap:$("header",e.wrap)}).init(),e.header=new Header({wrap:$("section.char",e.wrap),data:e.statData}).init(),e.section=new Section({wrap:$("section.variation",e.wrap)}).init(),e.setTopBarEvents(!0),console.log("=> 1. setInstance() default page _.setTopBarEvents(true)  _.statData : ",e.statData),e.setHeaderEvents(!0),e.setSectionEvents(!0),e.changeSectionBtnsStatus();break;case"view":console.log("=> 2. setInstance() view page 저장한 스탯 보기 : _.option, _.statData : ",e.option,e.statData),i=a($.extend(e.statData,{page:e.option.page})),e.wrap.append(i),e.topBar=new TopBar({page:e.option.page,wrap:$("header",e.wrap)}).init(),e.section=new Section({wrap:$("section.variation",e.wrap),model:e.model}).init(),e.setTopBarEvents(!0),truthy(e.option.useHighlightForDiff)&&(l=getChangedStats(e.defaultStatsForDiff,e.statData),e.section.setHighlightChangedStats(l));break;case"modify":console.log("=> 3. setInstance() modify page 스탯 수정 : _.option.data , _.statData : ",e.option.data,e.statData),i=a($.extend(e.option.data,{page:e.option.page})),e.wrap.append(i),e.topBar=new TopBar({page:e.option.page,wrap:$("header",e.wrap)}).init(),e.header=new Header({wrap:$("section.char",e.wrap),data:e.option.data,model:e.model}).init(),e.section=new Section({wrap:$("section.variation",e.wrap),model:e.model}).init(),e.setTopBarEvents(!0),e.setHeaderEvents(!0),e.setSectionEvents(!0),e.changeSectionBtnsStatus(),l=getChangedStats(e.defaultStatsForDiff,e.statData),e.section.setHighlightChangedStats(l);break;case"reset:modify":console.log("=> 4. setInstance() reset:modify 수정/리셋 : _.option, _.statData : ",e.option,e.statData),i=a($.extend(e.statData,{page:e.option.page,classImageUrl:`${e.option.staticDomain}/resource/lineage/profile/char${e.option.classId}_m.png`})),e.wrap.append(i),e.topBar=new TopBar({page:e.option.page,wrap:$("header",e.wrap)}).init(),e.header=new Header({wrap:$("section.char",e.wrap),data:e.statData,model:e.model}).init(),e.section=new Section({wrap:$("section.variation",e.wrap),model:e.model}).init(),e.setTopBarEvents(!0),e.setHeaderEvents(!0),e.setSectionEvents(!0),e.changeSectionBtnsStatus()}e.setLevelUpKeyEvents(e.statData.type)}switchMode(t,e){let a=this;allOf("view"===t,"modify"===e)&&(a.option.page="modify",console.log(" => 스위치모드 switchMode(),  _.option ",a.option),a.init())}setTopBarEvents(t){let e=this,a=$(e.topBar);a.length<=0||(console.log(" => 이벤트 체크 setTopBarEvents() _.statData 전 : ",e.statData),truthy(t)?(a.on(TopBar.EVT_CLOSE,function(t){$(e).trigger({type:StatSimulator.EVT_CLOSE})}),a.on(TopBar.EVT_SAVE,function(t){if(truthy(e.loading.isLoading))return;if(falsy(e.option.isLogin)){e.global.alert(ALERT.CAN_SAVE_STAT_AFTER_LOGIN);return}if(allOf("default"===e.option.page,e.option.savedUserStatNum>=e.model.USER_STAT_NUM_LIMIT)){e.global.alert(ALERT.SAVE_STAT_LIMIT);return}if(falsy(e.isEmptyRemainStatPoint()))return;let a=null,i=null;switch(e.option.page){case"default":i={classId:parseInt10((a=e.statData).classType),targetLevel:a.targetLevel,level:a.level,statMetaInfo:{hp:a.HP,mp:a.MP,mainStat:{STR:a.STR,CON:a.CON,DEX:a.DEX,INT:a.INT,WIS:a.WIS,CHA:a.CHA}},statPointInfo:{remainStatPoint:a.remainStatPoint,totalStatPoint:a.totalStatPoint,remainElixirPoint:a.remainElixirPoint,totalElixirPoint:a.totalElixirPoint,usedElixir:e.header.isCheckedElixirStatCheckBox()}},console.log("=>  stat(sendData) : ",a,e.option,e.data.idx),saveNewUserStat({apiDomain:e.option.apiDomain,idx:e.data.idx,sendData:i,beforeSend:()=>e.loading.start()}).then((t,a,i)=>{console.log("saveNewUserStat - data :",t),e.loading.end(),"success"===t.result?$(e).trigger({type:StatSimulator.EVT_SAVE_STAT_COMPLETE}):falsy(handleApiError(t))&&e.global.alert(ALERT.FAIL_SAVE_STAT)}).catch(t=>{e.loading.end(),falsy(handleApiError(t.jqXHR))&&e.global.alert(ALERT.FAIL_SAVE_STAT)});break;case"modify":a=e.statData,console.log("=>  setTopBarEvents() case modify _.statData : ",e.statData),i={classId:parseInt10(a.classType),targetLevel:a.targetLevel,level:a.level,statMetaInfo:{hp:a.HP,mp:a.MP,mainStat:{STR:a.STR,CON:a.CON,DEX:a.DEX,INT:a.INT,WIS:a.WIS,CHA:a.CHA}},statPointInfo:{remainStatPoint:a.remainStatPoint,totalStatPoint:a.totalStatPoint,remainElixirPoint:a.remainElixirPoint,totalElixirPoint:a.totalElixirPoint,usedElixir:e.header.isCheckedElixirStatCheckBox()}},console.log("=> StatSimulator.js modify 수정 초기화 stat, sendData, _.option, _.data : ",a,i,e.option,e.data),saveUserStat({apiDomain:e.option.apiDomain,idx:e.option.data.idx,sendData:i,beforeSend:()=>e.loading.start()}).then((t,a,i)=>{console.log("saveUserStat - data :",t),e.loading.end(),"success"===t.result?$(e).trigger({type:StatSimulator.EVT_SAVE_STAT_COMPLETE}):falsy(handleApiError(t))&&e.global.alert(ALERT.FAIL_SAVE_STAT)}).catch(t=>{e.loading.end(),falsy(handleApiError(t.jqXHR))&&e.global.alert(ALERT.FAIL_SAVE_STAT)})}}),a.on(TopBar.EVT_TRY_RESET,function(t){console.log("TopBar.EVT_TRY_RESET")}),a.on(TopBar.EVT_RESET,function(t){console.log("TopBar.EVT_RESET"),e.resetDefaultStat()}),a.on(TopBar.EVT_MODIFY,function(t){if(console.log("TopBar.EVT_MODIFY"),falsy(e.option.isLogin)){e.global.alert(ALERT.CAN_MODIFY_STAT_AFTER_LOGIN);return}e.switchMode(e.option.page,"modify")}),a.on(TopBar.EVT_DELETE,function(t){if(allOf(isString(e.statData.idx),""!==e.statData.idx)){let a=ALERT.TRY_DELETE_STAT({level:e.statData.targetLevel}),i=e.global.confirm(a);i&&e.callDeleteApi(e.statData.idx)}})):a.off(TopBar.EVT_CLOSE).off(TopBar.EVT_SAVE).off(TopBar.EVT_TRY_RESET).off(TopBar.EVT_RESET).off(TopBar.EVT_MODIFY).off(TopBar.EVT_DELETE))}resetDefaultStat(){let t=this;switch(console.log(" 01 리셋 시작 resetDefaultStat() : _.statData ",t.option.data,t.statData),t.option.page){case"default":t.statData=$.extend({},t.defaultStatsForDiff),console.log(" 02 default 리셋  resetDefaultStat() : page=default : _.statData ",t.statData),t.statDataFirstAtLevel=$.extend({},t.statData),t.isCompleteSetBaseStat=!1,t.setInstance({page:"default"});break;case"modify":console.log(" 02 modify 리셋  resetDefaultStat() : page=modify ~ 2 : _.statData",t.statData,t.statData.totalStatPoint),t.statData.remainElixirPoint=t.statData.totalElixirPoint,t.statData.totalStatPoint=0,t.data=$.extend(t.statData,t.defaultStatsForDiff),t.statData=$.extend({},t.data),console.log(" 03 modify 리셋 resetDefaultStat() : page=modify ~ 3 : _.data, _.statData ",t.data,t.statData,t.statData.totalStatPoint),t.statDataFirstAtLevel=$.extend({},t.statData),t.defaultStatsForDiff=$.extend({},t.statData),t.isCompleteSetBaseStat=!1,t.setInstance({page:"reset:modify"})}}callDeleteApi(t){let e=this;if(!truthy(e.loading.isLoading)){if(falsy(e.option.isLogin)){e.global.alert(ALERT.CAN_DELETE_STAT_AFTER_LOGIN);return}deleteUserStat({apiDomain:e.option.apiDomain,idx:t,beforeSend:()=>e.loading.start()}).then((t,a,i)=>{console.log("deleteUserStat - data :",t),e.loading.end(),"success"===t.result?$(e).trigger({type:StatSimulator.EVT_DELETE_STAT_COMPLETE}):falsy(handleApiError(t))&&e.global.alert(ALERT.FAIL_DELETE_STAT)}).catch(t=>{e.loading.end(),falsy(handleApiError(jqXHR))&&e.global.alert(ALERT.FAIL_DELETE_STAT)})}}setHeaderEvents(t){let e=this,a=$(e.header);a.length<=0||(truthy(t)?(a.on(Header.EVT_LEVEL_UP,function(t){if(anyOf(falsy(e.header.isUsableLevelUpBtn()),truthy(e.loading.isLoading)))return;if(falsy(e.isCompleteSetBaseStat)){e.global.alert(ALERT.CAN_LEVELUP_AFTER_INIT_BASE_STAT);return}if(console.log("=> setHeaderEvents() EVT_LEVEL_UP _.statData.remainStatPoint, truthy(_.isCompleteSetBaseStat) : ",e.statData.remainStatPoint,truthy(e.isCompleteSetBaseStat)),e.statData.remainStatPoint>=3&&truthy(e.isCompleteSetBaseStat)){e.global.alert(ALERT.DISABLE_LEVELUP);return}if(e.statData.level>=e.statData.targetLevel){e.header.setLevelUpBtnUsable(!1,e.model.DEVICE_TYPE),e.global.alert(ALERT.COMPLETE_TARGET_LEVEL);return}let a={classId:parseInt10(e.option.classId),level:parseInt10(e.option.level),targetLevel:parseInt10(e.option.targetLevel),hp:parseStrIntToInt(e.statData.HP),mp:parseStrIntToInt(e.statData.MP),currentStat:{STR:parseInt10(e.statData.STR),INT:parseInt10(e.statData.INT),DEX:parseInt10(e.statData.DEX),WIS:parseInt10(e.statData.WIS),CON:parseInt10(e.statData.CON),CHA:parseInt10(e.statData.CHA)}};e.callCalculateApiByLevelUp(a)}),a.on(Header.EVT_CHECK_ELIXIR_CHECKBOX,function(t){console.log("EVT_CHECK_ELIXIR_CHECKBOX"),falsy(e.header.isCheckedElixirStatCheckBox())?allOf(truthy(e.isUsedElixirAtCurrentLevel),e.statData.elixirStat>0)?(e.global.alert(ALERT.CAN_PROCESS_AFTER_EXHAUST_ELIXIR_STAT),e.header.setElixirStatCheckBoxChecked(!0),e.statData.elixirUseYN=!0):(e.header.activateElixirStatField(!1),e.statData.elixirUseYN=!1):e.statData.elixirUseYN=!0,e.changeSectionBtnsStatus()})):a.off(Header.EVT_LEVEL_UP).off(Header.EVT_CHECK_ELIXIR_CHECKBOX))}callCalculateApi(t){let e=this,a=e.option,i=e.model;if(truthy(e.loading.isLoading))return;let l=parseInt(t.sendData.currentStat[t.consumeStatName])+1,n=getCostPointByStat(l,t.type);console.log("=> callCalculateApi() 플러스마이너스버튼클릭 소모포인트/statData : ",l,n,e.statData),e.statData.remainStatPoint,e.statData.remainElixirPoint,calculateStat({apiDomain:a.apiDomain,classId:a.classId,sendData:t.sendData,beforeSend:()=>e.loading.start()}).then((a,o,s)=>{e.loading.end();let r=a.formattedSubStat,S=allOf(isDefined(a),isDefined(r))?r.attribute:null,c=null,E=null;switch(t.type){case"plus":if(console.log("=> callCalculateApi() 플러스마이너스버튼클릭 : remainStatPoint/remainElixirPoint/totalElixirPoint : ",e.statData.remainStatPoint,e.statData.remainElixirPoint,e.statData.totalElixirPoint),e.statData.remainStatPoint-n>=0)e.statData.remainStatPoint=e.statData.remainStatPoint-n,e.statData.totalStatPoint=parseInt10(e.statData.totalStatPoint)+parseInt10(n),e.section.activatePlusBtn(t.consumeStatName,!0),console.log("스탯 플러스 가능함 !! -->",t.consumeStatName);else{let d=ALERT.NEED_STAT_POINT({point:n});return e.global.alert(d),!1}let p=getStatMaxByLevel(parseInt(e.statData.targetLevel));if(p<l)return e.global.alert(ALERT.STAT_MAX_LIMIT),!1;c={type:i.DEVICE_TYPE,classType:e.option.classId,level:e.statData.level,targetLevel:e.statData.targetLevel,HP:getDefined(a.hp,"0"),MP:getDefined(a.mp,"0"),STR:parseInt10(getDefined(a.mainStat.STR,0)),DEX:parseInt10(getDefined(a.mainStat.DEX,0)),INT:parseInt10(getDefined(a.mainStat.INT,0)),CON:parseInt10(getDefined(a.mainStat.CON,0)),WIS:parseInt10(getDefined(a.mainStat.WIS,0)),CHA:parseInt10(getDefined(a.mainStat.CHA,0)),DAMAGE_SHORT:getDefined(r.STR.damageShort,"0"),HIT_SHORT:getDefined(r.STR.hitShort,"0"),FATAL_SHORT:getDefined(r.STR.fatalShort,"0"),WEIGHT:getDefined(r.STR.weight,"0"),DAMAGE_WIZ:getDefined(r.INT.damageWiz,"0"),HIT_WIZ:getDefined(r.INT.hitWiz,"0"),FATAL_WIZ:getDefined(r.INT.fatalWiz,"0"),MB:getDefined(r.INT.mb,"0"),MP_MINUS:getDefined(r.INT.mpMinus,"0"),DAMAGE_LONG:getDefined(r.DEX.damageLong,"0"),HIT_LONG:getDefined(r.DEX.hitLong,"0"),FATAL_LONG:getDefined(r.DEX.fatalLong,"0"),AC:getDefined(r.DEX.ac,"0"),ER:getDefined(r.DEX.er,"0"),LEVELUP_MP_PLUS_MIN:getDefined(r.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(r.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(r.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(r.WIS.mpRecoverLiquor,"0"),MR:getDefined(r.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(r.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(r.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(r.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(r.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(r.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(r.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(r.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(r.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(r.CON.resDragon,"0"),CON_RES_FEAR:getDefined(r.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(r.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(r.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(r.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(r.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(r.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(r.CHA.statusTimeReduction,"0"),FIRE:isDefined(S)?getDefined(S.fire,"0"):"0",WATER:isDefined(S)?getDefined(S.water,"0"):"0",STORM:isDefined(S)?getDefined(S.storm,"0"):"0",LAND:isDefined(S)?getDefined(S.land,"0"):"0",HIT_SKILL:isDefined(S)?getDefined(S.hitSkill,"0"):"0",RES_SKILL:isDefined(S)?getDefined(S.resSkill,"0"):"0",HIT_SUMMON:isDefined(S)?getDefined(S.hitSummon,"0"):"0",RES_SUMMON:isDefined(S)?getDefined(S.resSummon,"0"):"0",HIT_DRAGON:isDefined(S)?getDefined(S.hitDragon,"0"):"0",RES_DRAGON:isDefined(S)?getDefined(S.resDragon,"0"):"0",HIT_FEAR:isDefined(S)?getDefined(S.hitFear,"0"):"0",RES_FEAR:isDefined(S)?getDefined(S.resFear,"0"):"0",remainStatPoint:e.statData.remainStatPoint,totalStatPoint:e.statData.totalStatPoint,remainElixirPoint:e.statData.remainElixirPoint,totalElixirPoint:e.statData.totalElixirPoint,elixirUseYN:e.header.isCheckedElixirStatCheckBox()},E=getChangedStats(e.statDataFirstAtLevel,c),e.header.setRemainStatPoint(c.remainStatPoint),e.header.setRemainElixirPoint(c.remainElixirPoint),e.isUsedElixirAtCurrentLevel=!0,e.header.setHpMp(E),e.section.setChangedStat(e.isCompleteSetBaseStat,E,c),e.section.setStatValueColor(e.statData.level),e.statData=c,e.consumedPoint=e.consumedPoint+n,e.lastConsumedStatName=t.consumeStatName||"";break;case"minus":console.log("===>> MINUS : ",n,e.consumedPoint," <<==="),e.statData.remainStatPoint=e.statData.remainStatPoint+n,c={type:i.DEVICE_TYPE,classType:e.option.classId,level:e.statData.level,targetLevel:e.statData.targetLevel,HP:getDefined(a.hp,"0"),MP:getDefined(a.mp,"0"),STR:parseInt10(getDefined(a.mainStat.STR,"0")),DEX:parseInt10(getDefined(a.mainStat.DEX,"0")),INT:parseInt10(getDefined(a.mainStat.INT,"0")),CON:parseInt10(getDefined(a.mainStat.CON,"0")),WIS:parseInt10(getDefined(a.mainStat.WIS,"0")),CHA:parseInt10(getDefined(a.mainStat.CHA,"0")),DAMAGE_SHORT:getDefined(r.STR.damageShort,"0"),HIT_SHORT:getDefined(r.STR.hitShort,"0"),FATAL_SHORT:getDefined(r.STR.fatalShort,"0"),WEIGHT:getDefined(r.STR.weight,"0"),DAMAGE_WIZ:getDefined(r.INT.damageWiz,"0"),HIT_WIZ:getDefined(r.INT.hitWiz,"0"),FATAL_WIZ:getDefined(r.INT.fatalWiz,"0"),MB:getDefined(r.INT.mb,"0"),MP_MINUS:getDefined(r.INT.mpMinus,"0"),DAMAGE_LONG:getDefined(r.DEX.damageLong,"0"),HIT_LONG:getDefined(r.DEX.hitLong,"0"),FATAL_LONG:getDefined(r.DEX.fatalLong,"0"),AC:getDefined(r.DEX.ac,"0"),ER:getDefined(r.DEX.er,"0"),LEVELUP_MP_PLUS_MIN:getDefined(r.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(r.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(r.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(r.WIS.mpRecoverLiquor,"0"),MR:getDefined(r.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(r.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(r.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(r.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(r.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(r.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(r.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(r.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(r.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(r.CON.resDragon,"0"),CON_RES_FEAR:getDefined(r.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(r.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(r.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(r.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(r.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(r.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(r.CHA.statusTimeReduction,"0"),FIRE:isDefined(S)?getDefined(S.fire,"0"):"0",WATER:isDefined(S)?getDefined(S.water,"0"):"0",STORM:isDefined(S)?getDefined(S.storm,"0"):"0",LAND:isDefined(S)?getDefined(S.land,"0"):"0",HIT_SKILL:isDefined(S)?getDefined(S.hitSkill,"0"):"0",RES_SKILL:isDefined(S)?getDefined(S.resSkill,"0"):"0",HIT_SUMMON:isDefined(S)?getDefined(S.hitSummon,"0"):"0",RES_SUMMON:isDefined(S)?getDefined(S.resSummon,"0"):"0",HIT_DRAGON:isDefined(S)?getDefined(S.hitDragon,"0"):"0",RES_DRAGON:isDefined(S)?getDefined(S.resDragon,"0"):"0",HIT_FEAR:isDefined(S)?getDefined(S.hitFear,"0"):"0",RES_FEAR:isDefined(S)?getDefined(S.resFear,"0"):"0",remainStatPoint:e.statData.remainStatPoint,totalStatPoint:e.statData.totalStatPoint,remainElixirPoint:e.statData.remainElixirPoint,totalElixirPoint:e.statData.totalElixirPoint,elixirUseYN:e.header.isCheckedElixirStatCheckBox()},console.log("receivedStats :",c),E=getChangedStats(e.statData,c),console.log("minus - changedStat :",E),e.header.setRemainStatPoint(c.remainStatPoint),e.header.setHpMp(E),e.section.setChangedStat(e.isCompleteSetBaseStat,E,c,e.statDataFirstAtLevel,e.defaultStatsForDiff),e.section.setStatValueColor(e.statData.level),e.statData=c,e.consumedPoint=e.consumedPoint-n}e.statData.remainStatPoint>0&&e.statData.level<=e.statData.targetLevel||(console.log("~ELSE~ 스탯 포인트 다 찍었다면 callCalculateApi remain stat is 0"),falsy(e.isCompleteSetBaseStat)&&truthy(e.statData.remainStatPoint<=0)&&e.statData.targetLevel>=e.model.LEVEL_INIT&&(console.log("show _confirmBaseStatModal  falsy(_.isCompleteSetBaseStat) //  _.statData.targetLevel > _.model.LEVEL_INIT // ",falsy(e.isCompleteSetBaseStat),truthy(e.statData.remainStatPoint<=0)),window.setTimeout(function(){e.confirmDistributeBaseStat()},50)),console.log(" ~ELSE~ ~~~ =======>> ",falsy(e.isCompleteSetBaseStat),falsy(e.header.isCheckedElixirStatCheckBox())),falsy(e.header.isCheckedElixirStatCheckBox())?console.log("checkbox not checked"):(console.log("checkbox checked"),e.statData.elixirStat<=0?(console.log("checkbox checked. elixir is 0."),falsy(e.isCompleteSetBaseStat)&&e.statData.targetLevel>e.model.LEVEL_INIT?(console.log("show _confirmBaseStatModal"),window.setTimeout(function(){e.confirmDistributeBaseStat()},50)):console.log("_.isCompleteSetBaseStat is true")):(console.log("-checkbox checked. elixir > 0."),falsy(isLevelCanConsumeElixirStat(parseInt(e.statData.level-i.LEVEL_INIT)))?console.log(`can not consume elixir at ${e.statData.level} level`):console.log(`can consume elixir at ${e.statData.level} level`)))),e.changeSectionBtnsStatus(),e.header.setHpMp(e.statData),e.focusWrap(e.statData.type)}).catch(t=>{console.log("calculateStat - error :",t),e.loading.end(),e.focusWrap(e.statData.type),falsy(handleApiError(t.jqXHR))&&e.global.alert(ALERT.FAIL_CALCULATE_STAT)})}callCalculateApiByConfirmBaseStat(t){let e=this,a=e.option,i=e.header,l=e.section;truthy(e.loading.isLoading)||calculateStat({apiDomain:a.apiDomain,classId:a.classId,sendData:t,beforeSend:()=>e.loading.start()}).then((a,n,o)=>{e.loading.end();let s=a.formattedSubStat,r=allOf(isDefined(a),isDefined(s))?s.attribute:null,S={page:e.option.page,type:e.model.DEVICE_TYPE,classType:parseInt10(t.classId),level:parseInt10(t.level),targetLevel:parseInt10(t.targetLevel),HP:getDefined(a.hp,"0"),MP:getDefined(a.mp,"0"),STR:parseInt10(getDefined(a.mainStat.STR,"0")),DEX:parseInt10(getDefined(a.mainStat.DEX,"0")),INT:parseInt10(getDefined(a.mainStat.INT,"0")),CON:parseInt10(getDefined(a.mainStat.CON,"0")),WIS:parseInt10(getDefined(a.mainStat.WIS,"0")),CHA:parseInt10(getDefined(a.mainStat.CHA,"0")),DAMAGE_SHORT:getDefined(s.STR.damageShort,"0"),HIT_SHORT:getDefined(s.STR.hitShort,"0"),FATAL_SHORT:getDefined(s.STR.fatalShort,"0"),WEIGHT:getDefined(s.STR.weight,"0"),DAMAGE_WIZ:getDefined(s.INT.damageWiz,"0"),HIT_WIZ:getDefined(s.INT.hitWiz,"0"),FATAL_WIZ:getDefined(s.INT.fatalWiz,"0"),MB:getDefined(s.INT.mb,"0"),MP_MINUS:getDefined(s.INT.mpMinus,"0"),DAMAGE_LONG:getDefined(s.DEX.damageLong,"0"),HIT_LONG:getDefined(s.DEX.hitLong,"0"),FATAL_LONG:getDefined(s.DEX.fatalLong,"0"),AC:getDefined(s.DEX.ac,"0"),ER:getDefined(s.DEX.er,"0"),LEVELUP_MP_PLUS_MIN:getDefined(s.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(s.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(s.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(s.WIS.mpRecoverLiquor,"0"),MR:getDefined(s.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(s.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(s.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(s.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(s.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(s.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(s.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(s.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(s.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(s.CON.resDragon,"0"),CON_RES_FEAR:getDefined(s.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(s.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(s.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(s.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(s.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(s.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(s.CHA.statusTimeReduction,"0"),FIRE:isDefined(r)?getDefined(r.fire,"0"):"0",WATER:isDefined(r)?getDefined(r.water,"0"):"0",STORM:isDefined(r)?getDefined(r.storm,"0"):"0",LAND:isDefined(r)?getDefined(r.land,"0"):"0",HIT_SKILL:isDefined(r)?getDefined(r.hitSkill,"0"):"0",RES_SKILL:isDefined(r)?getDefined(r.resSkill,"0"):"0",HIT_SUMMON:isDefined(r)?getDefined(r.hitSummon,"0"):"0",RES_SUMMON:isDefined(r)?getDefined(r.resSummon,"0"):"0",HIT_DRAGON:isDefined(r)?getDefined(r.hitDragon,"0"):"0",RES_DRAGON:isDefined(r)?getDefined(r.resDragon,"0"):"0",HIT_FEAR:isDefined(r)?getDefined(r.hitFear,"0"):"0",RES_FEAR:isDefined(r)?getDefined(r.resFear,"0"):"0",remainStatPoint:parseInt10(e.statData.remainStatPoint),totalStatPoint:parseInt10(e.statData.totalStatPoint),remainElixirPoint:parseInt10(e.statData.remainElixirPoint),totalElixirPoint:parseInt10(e.statData.totalElixirPoint),elixirUseYN:i.isCheckedElixirStatCheckBox()};e.statData=S,e.statDataFirstAtLevel=$.extend({},e.statData),e.consumedPoint=0,e.isCompleteSetBaseStat=!0,console.log("=> callCalculateApiByConfirmBaseStat() isCompleteSetBaseStat  receivedStats :",S),i.setRemainStatPoint(S.remainStatPoint),i.setTotalStatPoint(S.totalStatPoint),i.setRemainElixirPoint(S.remainElixirPoint),i.setTotalElixirPoint(S.totalElixirPoint),i.setHpMp(S),l.reset(S),e.changeSectionBtnsStatus();let c=getChangedStats(e.statData,e.defaultStatsForDiff);l.setHighlightChangedStats(c),l.setStatValueColor(e.statData.level),e.focusWrap(e.statData.type)}).catch(t=>{console.log("callCalculateApiByConfirmBaseStat() - error :",t),e.loading.end(),e.focusWrap(e.statData.type),falsy(handleApiError(t.jqXHR))&&e.global.alert(ALERT.FAIL_CALCULATE_STAT)})}callCalculateApiByLevelUp(t){var e=this,a=e.statData;if(console.log(" => callCalculateApiByLevelUp() 레벨업버튼 > 시작 - statData/_.option :",a,e.option),truthy(e.loading.isLoading))return;let i=e.statData.level+1;calculateStatByLevelUp({apiDomain:e.option.apiDomain,classId:e.option.classId,level:i,targetLevel:e.option.targetLevel,remainElixirPoint:e.statData.remainElixirPoint,sendData:t,beforeSend:()=>e.loading.start()}).then((t,l,n)=>{if(console.log(" => calculateStatByLevelUp() 레벨업버튼 > then >  statData.remainElixirPoint :",a.remainElixirPoint),e.loading.end(),truthy(e.isCompleteSetBaseStat)){console.log(" => callCalculateApiByLevelUp() 베이스 스탯 확인 이후 레벨업 클릭, 엘릭서가 생기면 사용 가능한 포인트로 더해주기! _.statData / _.statData.remainStatPoint : ",e.statData,e.statData.remainStatPoint);let o=getElixirIncrease(i);console.log("=> 레벨별 엘릭서개수 체크 : nextLevel, increase: ",i,o),isLevelCanConsumeElixirStat(parseInt(i-e.model.LEVEL_INIT))&&(e.statData.remainTotalStat=e.statData.remainTotalStat+1,e.statData.remainElixirPoint>0?(e.statData.remainStatPoint=e.statData.remainStatPoint+1+o,e.statData.remainElixirPoint=e.statData.remainElixirPoint-o,e.statData.elixirStat=e.statData.elixirStat+o,e.statData.totalElixirPoint=e.statData.totalElixirPoint):e.statData.remainStatPoint=e.statData.remainStatPoint+1)}let s=t.formattedSubStat,r=allOf(isDefined(t),isDefined(s))?s.attribute:null,S={page:e.option.page,type:e.model.DEVICE_TYPE,classType:e.option.classId,STR:parseInt10(getDefined(t.mainStat.STR,"0")),DEX:parseInt10(getDefined(t.mainStat.DEX,"0")),INT:parseInt10(getDefined(t.mainStat.INT,"0")),CON:parseInt10(getDefined(t.mainStat.CON,"0")),WIS:parseInt10(getDefined(t.mainStat.WIS,"0")),CHA:parseInt10(getDefined(t.mainStat.CHA,"0")),level:parseInt10(t.level),targetLevel:parseInt10(t.targetLevel),HP:getDefined(t.hp,"0"),MP:getDefined(t.mp,"0"),DAMAGE_SHORT:getDefined(s.STR.damageShort,"0"),HIT_SHORT:getDefined(s.STR.hitShort,"0"),FATAL_SHORT:getDefined(s.STR.fatalShort,"0"),WEIGHT:getDefined(s.STR.weight,"0"),DAMAGE_WIZ:getDefined(s.INT.damageWiz,"0"),HIT_WIZ:getDefined(s.INT.hitWiz,"0"),FATAL_WIZ:getDefined(s.INT.fatalWiz,"0"),MB:getDefined(s.INT.mb,"0"),MP_MINUS:getDefined(s.INT.mpMinus,"0"),DAMAGE_LONG:getDefined(s.DEX.damageLong,"0"),HIT_LONG:getDefined(s.DEX.hitLong,"0"),FATAL_LONG:getDefined(s.DEX.fatalLong,"0"),AC:getDefined(s.DEX.ac,"0"),ER:getDefined(s.DEX.er,"0"),LEVELUP_MP_PLUS_MIN:getDefined(s.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(s.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(s.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(s.WIS.mpRecoverLiquor,"0"),MR:getDefined(s.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(s.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(s.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(s.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(s.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(s.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(s.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(s.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(s.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(s.CON.resDragon,"0"),CON_RES_FEAR:getDefined(s.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(s.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(s.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(s.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(s.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(s.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(s.CHA.statusTimeReduction,"0"),FIRE:isDefined(r)?getDefined(r.fire,"0"):"0",WATER:isDefined(r)?getDefined(r.water,"0"):"0",STORM:isDefined(r)?getDefined(r.storm,"0"):"0",LAND:isDefined(r)?getDefined(r.land,"0"):"0",HIT_SKILL:isDefined(r)?getDefined(r.hitSkill,"0"):"0",RES_SKILL:isDefined(r)?getDefined(r.resSkill,"0"):"0",HIT_SUMMON:isDefined(r)?getDefined(r.hitSummon,"0"):"0",RES_SUMMON:isDefined(r)?getDefined(r.resSummon,"0"):"0",HIT_DRAGON:isDefined(r)?getDefined(r.hitDragon,"0"):"0",RES_DRAGON:isDefined(r)?getDefined(r.resDragon,"0"):"0",HIT_FEAR:isDefined(r)?getDefined(r.hitFear,"0"):"0",RES_FEAR:isDefined(r)?getDefined(r.resFear,"0"):"0",remainStatPoint:a.remainStatPoint,totalStatPoint:a.totalStatPoint,remainElixirPoint:a.remainElixirPoint,totalElixirPoint:a.totalElixirPoint,elixirUseYN:e.header.isCheckedElixirStatCheckBox()};if(console.log("receivedStats :",S),S.level>e.model.LEVEL_USABLE_ELIXIR_POINT)return;S.remainElixirPoint<=0&&e.header.setElixirStatCheckBoxChecked(!1),console.log("=> 보유 엘릭서 receivedStats.remainElixirPoint : ",S.remainElixirPoint),e.header.setRemainStatPoint(S.remainStatPoint),e.header.setTotalStatPoint(S.totalStatPoint),e.header.setRemainElixirPoint(S.remainElixirPoint),e.header.setTotalElixirPoint(S.totalElixirPoint),e.header.setLevel(S.level),e.header.setHpMp(S),e.section.reset(S),e.statData=S,e.statDataFirstAtLevel=$.extend({},e.statData),e.consumedPoint=0,e.isUsedElixirAtCurrentLevel=!1,e.changeSectionBtnsStatus();let c=getChangedStats(e.statData,e.defaultStatsForDiff);e.section.setHighlightChangedStats(c),e.section.setStatValueColor(e.statData.level),e.focusWrap(e.statData.type)}).catch(t=>{console.log("calculateStatByLevelUp - error :",t),e.loading.end(),e.focusWrap(e.statData.type),falsy(handleApiError(t.jqXHR))&&e.global.alert(ALERT.FAIL_CALCULATE_STAT)})}confirmDistributeBaseStat(){let t=this,e=!0;t.option.targetLevel>t.statData.level&&(e=t.global.confirm(ALERT.COMPLETE_DISTRIBUTE_BASE_STAT)),console.log("=> confirmDistributeBaseStat() 베이스 스탯 분배 후 컨펌 완료 _.option, _.statData : ",e,t.option,t.statData),truthy(e)?(t.header.activedElixirStatCheckBox(),t.statData.remainElixirPoint>0&&(t.statData.remainStatPoint=t.statData.remainStatPoint+1,t.statData.remainElixirPoint=t.statData.remainElixirPoint-1,console.log("베이스 스탯 분배 완료 후, callCalculateApiByConfirmBaseStat() 하고 나서 엘릭서 레벨이 생기면 사용 가능한 포인트로 더해주기:",t.statData.remainStatPoint,t.statData.remainElixirPoint)),t.callCalculateApiByConfirmBaseStat({classId:parseInt10(t.option.classId),level:parseInt10(t.statData.level),targetLevel:parseInt10(t.option.targetLevel),hp:parseInt10(t.statData.HP),mp:parseInt10(t.statData.MP),currentStat:{STR:parseInt10(t.statData.STR),INT:parseInt10(t.statData.INT),DEX:parseInt10(t.statData.DEX),WIS:parseInt10(t.statData.WIS),CON:parseInt10(t.statData.CON),CHA:parseInt10(t.statData.CHA)},differenceStat:{STR:0,INT:0,DEX:0,WIS:0,CON:0,CHA:0},completeBaseStat:!0})):(t.isCompleteSetBaseStat=!1,t.header.setLevelUpBtnUsable(!1,t.model.DEVICE_TYPE),""!==t.lastConsumedStatName&&t.minusStat(t.lastConsumedStatName))}setSectionEvents(t){let e=this,a=$(e.section);a.length<=0||(truthy(t)?(a.on(Section.EVT_PLUS_STAT,function(t){truthy(e.loading.isLoading)||e.plusStat(t.statName)}),a.on(Section.EVT_MINUS_STAT,function(t){truthy(e.loading.isLoading)||e.minusStat(t.statName)})):a.off(Section.EVT_PLUS_STAT).off(Section.EVT_MINUS_STAT))}plusStat(t){let e=this.statData,a={classId:parseInt10(this.option.classId),level:parseInt10(e.level),targetLevel:parseInt10(e.targetLevel),hp:parseStrIntToInt(e.HP),mp:parseStrIntToInt(e.MP),currentStat:{STR:parseInt10(e.STR),CON:parseInt10(e.CON),DEX:parseInt10(e.DEX),INT:parseInt10(e.INT),WIS:parseInt10(e.WIS),CHA:parseInt10(e.CHA)},differenceStat:{STR:"STR"===t?1:0,INT:"INT"===t?1:0,DEX:"DEX"===t?1:0,WIS:"WIS"===t?1:0,CON:"CON"===t?1:0,CHA:"CHA"===t?1:0},completeBaseStat:!1};if(this.statData.remainStatPoint>0)this.callCalculateApi({type:"plus",pointType:"remainStat",sendData:a,consumeStatName:t});else if(falsy(this.header.isCheckedElixirStatCheckBox()))this.global.alert(ALERT.REMAIN_STAT_ZERO);else if(this.statData.remainElixirPoint<=0)this.global.alert(ALERT.REMAIN_STAT_ZERO);else{if(falsy(isLevelCanConsumeElixirStat(parseInt(e.level-this.model.LEVEL_INIT)))){this.global.alert(ALERT.IMPOSSIBLE_LEVEL_CONSUME_ELIXIR_STAT);return}this.callCalculateApi({type:"plus",pointType:"elixirStat",sendData:a,consumeStatName:t})}}minusStat(t){if(not(isString)(t))throw Error("statName parameter type must be String.");if(this.consumedPoint<=0){this.global.alert(ALERT.NO_UNDO_STAT);return}let e=this.statData,a={classId:parseInt10(this.option.classId),level:parseInt10(e.level),targetLevel:parseInt10(e.targetLevel),hp:parseStrIntToInt(e.HP),mp:parseStrIntToInt(e.MP),currentStat:{STR:parseInt10(e.STR),CON:parseInt10(e.CON),DEX:parseInt10(e.DEX),INT:parseInt10(e.INT),WIS:parseInt10(e.WIS),CHA:parseInt10(e.CHA)},differenceStat:{STR:"STR"===t?-1:0,INT:"INT"===t?-1:0,DEX:"DEX"===t?-1:0,WIS:"WIS"===t?-1:0,CON:"CON"===t?-1:0,CHA:"CHA"===t?-1:0},completeBaseStat:!1};this.callCalculateApi({type:"minus",pointType:"remainStat",sendData:a,consumeStatName:t})}changeSectionBtnsStatus(){let t=this.header,e=this.section,a=this.statDataFirstAtLevel;console.log("=> changeSectionBtnsStatus() 버튼 이벤트 시작  _.option.page / _.option.data,  / _.statData: ",this.option.page,this.option.data,this.statData),e.activateAllMinusBtns(!1),e.activateAllPlusBtns(!1);let i=parseStrIntToInt(this.statData.remainStatPoint),l=parseStrIntToInt(this.statData.remainElixirPoint);i>0?(e.activateAllPlusBtns(!0),falsy(t.isCheckedElixirStatCheckBox())?(console.log("checkbox not checked"),t.activateElixirStatField(!1)):(console.log("checkbox checked"),falsy(isLevelCanConsumeElixirStat(parseInt(this.statData.level-this.model.LEVEL_INIT)))?(console.log(`can not consume elixir at ${this.statData.level} level`),t.activateElixirStatField(!1)):(console.log(`can consume elixir at ${this.statData.level} level`),t.activateElixirStatField(!0)))):(e.activateAllPlusBtns(!1),isNaN(i)?t.setLevelUpBtnUsable(!1,this.model.DEVICE_TYPE):falsy(t.isCheckedElixirStatCheckBox())?(console.log("checkbox not checked"),t.setLevelUpBtnUsable(!0,this.model.DEVICE_TYPE),t.activateElixirStatField(!1)):this.statData.remainElixirPoint<=0?(console.log("checkbox checked. elixir is 0."),t.setLevelUpBtnUsable(!0,this.model.DEVICE_TYPE),t.activateElixirStatField(!1)):(console.log("checkbox checked. elixir > 0."),falsy(isLevelCanConsumeElixirStat(parseInt(this.statData.level-this.model.LEVEL_INIT)))?(console.log(`can not consume elixir at ${this.statData.level} level`),t.setLevelUpBtnUsable(!0,this.model.DEVICE_TYPE),t.activateElixirStatField(!1)):(console.log(`can consume elixir at ${this.statData.level} level`),t.activateElixirStatField(!0)))),"modify"==this.option.page&&this.statData.level<this.statData.targetLevel&&t.setLevelUpBtnUsable(!0,this.model.DEVICE_TYPE),l<=0&&this.header.activateElixirStatField(!1);let n=parseInt10(this.statData.STR),o=parseInt10(this.statData.DEX),s=parseInt10(this.statData.INT),r=parseInt10(this.statData.CON),S=parseInt10(this.statData.WIS),c=parseInt10(this.statData.CHA);if(parseInt10(a.STR)<n&&e.activateMinusBtn("STR",!0),parseInt10(a.DEX)<o&&e.activateMinusBtn("DEX",!0),parseInt10(a.INT)<s&&e.activateMinusBtn("INT",!0),parseInt10(a.CON)<r&&e.activateMinusBtn("CON",!0),parseInt10(a.WIS)<S&&e.activateMinusBtn("WIS",!0),parseInt10(a.CHA)<c&&e.activateMinusBtn("CHA",!0),truthy(this.isCompleteSetBaseStat))falsy(t.isCheckedElixirStatCheckBox())?console.log("checkbox not checked"):(console.log("checkbox checked"),this.statData.remainElixirPoint<=0?console.log("checkbox checked. elixir is 0."):(console.log("checkbox checked. elixir > 0."),falsy(isLevelCanConsumeElixirStat(parseInt(this.statData.level-this.model.LEVEL_INIT)))?console.log(`can not consume elixir at ${this.statData.level} level`):console.log(`can consume elixir at ${this.statData.level} level`)));else{let E=parseInt10(this.option.classId),d=this.model.BASE_STAT_MAX.default||{},p=this.model.BASE_STAT_MAX[E]||{},u={STR:void 0!==p.STR?p.STR:d.STR,DEX:void 0!==p.DEX?p.DEX:d.DEX,INT:void 0!==p.INT?p.INT:d.INT,CON:void 0!==p.CON?p.CON:d.CON,WIS:void 0!==p.WIS?p.WIS:d.WIS,CHA:void 0!==p.CHA?p.CHA:d.CHA};u.STR<=n&&e.activatePlusBtn("STR",!1),u.DEX<=o&&e.activatePlusBtn("DEX",!1),u.INT<=s&&e.activatePlusBtn("INT",!1),u.CON<=r&&e.activatePlusBtn("CON",!1),u.WIS<=S&&e.activatePlusBtn("WIS",!1),u.CHA<=c&&e.activatePlusBtn("CHA",!1)}let T=getStatMaxByLevel(parseInt(this.statData.targetLevel));if(T<=n&&e.activatePlusBtn("STR",!1),T<=o&&e.activatePlusBtn("DEX",!1),T<=s&&e.activatePlusBtn("INT",!1),T<=r&&e.activatePlusBtn("CON",!1),T<=S&&e.activatePlusBtn("WIS",!1),T<=c&&e.activatePlusBtn("CHA",!1),this.statData.level>=this.statData.targetLevel){this.header.setLevelUpBtnUsable(!1,this.model.DEVICE_TYPE);return}console.log("=> changeSectionBtnsStatus() 버튼 이벤트 끝~~~ _.option.page / _.option.data,  / _.statData: ",this.option.page,this.option.data,this.statData)}setLevelUpKeyEvents(t){let e=this;"pc"===t&&$(document).off("keyup.levelup",".simulator__stat").on("keyup.levelup",".simulator__stat",function(t){anyOf(86===t.keyCode,86===t.which)&&$(e.header).trigger({type:Header.EVT_LEVEL_UP})})}focusWrap(t){"pc"===t&&$(".simulator__stat",this.wrap).focus()}isEmptyRemainStatPoint(){return!(this.statData.remainStatPoint>0)||(this.global.alert(ALERT.REQUIRE_EXHAUST_STAT),!1)}destroyContents(){let t=this;isDefined(t.topBar)&&(t.setTopBarEvents(!1),t.topBar.destroy(),t.topBar=null),isDefined(t.header)&&(t.setHeaderEvents(!1),t.header.destroy(),t.header=null),isDefined(t.section)&&(t.setSectionEvents(!1),t.section.destroy(),t.section=null)}destroy(t=null){this.destroyContents(),this.wrap.empty()}removeTopBar(){let t=this;isDefined(t.topBar)&&(t.setTopBarEvents(!1),t.topBar.destroy(),t.topBar=null),$(".simulator__stat > header",t.wrap).remove()}}StatSimulator.EVT_CLOSE="EVT_CLOSE",StatSimulator.EVT_SAVE_STAT_COMPLETE="EVT_SAVE_STAT_COMPLETE",StatSimulator.EVT_DELETE_STAT_COMPLETE="EVT_DELETE_STAT_COMPLETE";const singletonModelId=Symbol(),singletonModelEnforcer=Symbol();class StatModel{constructor(t){if(t!==singletonModelEnforcer)throw Error("StatModel can not use construct. use getInstance method");let e=this;e.LEVEL_INIT=50,e.LEVEL_MAX=110,e.LEVEL_USABLE_ELIXIR_POINT=110,e.BASE_STAT_MAX={default:{STR:20,DEX:20,INT:20,CON:20,WIS:20,CHA:20},0:{DEX:18,INT:18},4:{DEX:19,INT:18,WIS:17},10:{DEX:16},11:{DEX:16}},e.STAT_LEVEL_COLORS=[{level:25,class:"em1"},{level:35,class:"em2"},{level:45,class:"em3"}],e.CHANGED_LEVEL_COLORS=[{level:25,class:"em1"},{level:35,class:"em2"},{level:50,class:"em3"}],e.DEVICE_TYPE="",e.DATA_INIT=null,e.SERVER_ID="",e.CLASS_ID="",e.CHAR_NAME="",e.USER_STAT_NUM_LIMIT=6}static getInstance(){return this[singletonModelId]||(this[singletonModelId]=new StatModel(singletonModelEnforcer)),this[singletonModelId]}static getDefaultStatData(t,e={page:"",type:"",classType:"",level:0,targetElixir:0,totalStatPoint:0,remainElixirPoint:0,totalElixirPoint:0,elixirUseYN:!1}){let a=t,i=a.formattedSubStat,l=allOf(isDefined(a),isDefined(i))?i.attribute:null,n={page:e.page,type:e.type,classType:e.classType,level:getDefined(a.level,e.LEVEL_INIT),HP:"-",MP:"-",STR:getDefined(a.mainStat.STR,0),DEX:getDefined(a.mainStat.DEX,0),INT:getDefined(a.mainStat.INT,0),CON:getDefined(a.mainStat.CON,0),WIS:getDefined(a.mainStat.WIS,0),CHA:getDefined(a.mainStat.CHA,0),DAMAGE_SHORT:getDefined(i.STR.damageShort,"0"),HIT_SHORT:getDefined(i.STR.hitShort,"0"),FATAL_SHORT:getDefined(i.STR.fatalShort,"0"),WEIGHT:getDefined(i.STR.weight,"0"),DAMAGE_LONG:getDefined(i.DEX.damageLong,"0"),HIT_LONG:getDefined(i.DEX.hitLong,"0"),FATAL_LONG:getDefined(i.DEX.fatalLong,"0"),AC:getDefined(i.DEX.ac,"0"),ER:getDefined(i.DEX.er,"0"),DAMAGE_WIZ:getDefined(i.INT.damageWiz,"0"),HIT_WIZ:getDefined(i.INT.hitWiz,"0"),FATAL_WIZ:getDefined(i.INT.fatalWiz,"0"),MB:getDefined(i.INT.mb,"0"),MP_MINUS:getDefined(i.INT.mpMinus,"0"),LEVELUP_MP_PLUS_MIN:getDefined(i.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(i.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(i.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(i.WIS.mpRecoverLiquor,"0"),MR:getDefined(i.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(i.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(i.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(i.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(i.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(i.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(i.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(i.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(i.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(i.CON.resDragon,"0"),CON_RES_FEAR:getDefined(i.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(i.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(i.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(i.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(i.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(i.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(i.CHA.statusTimeReduction,"0"),FIRE:isDefined(l)?getDefined(l.FIRE,"0"):"0",WATER:isDefined(l)?getDefined(l.WATER,"0"):"0",STORM:isDefined(l)?getDefined(l.STORM,"0"):"0",LAND:isDefined(l)?getDefined(l.LAND,"0"):"0",HIT_SKILL:isDefined(l)?getDefined(l.hitSkill,"0"):"0",RES_SKILL:isDefined(l)?getDefined(l.resSkill,"0"):"0",HIT_SUMMON:isDefined(l)?getDefined(l.hitSummon,"0"):"0",RES_SUMMON:isDefined(l)?getDefined(l.resSummon,"0"):"0",HIT_DRAGON:isDefined(l)?getDefined(l.hitDragon,"0"):"0",RES_DRAGON:isDefined(l)?getDefined(l.resDragon,"0"):"0",HIT_FEAR:isDefined(l)?getDefined(l.hitFear,"0"):"0",RES_FEAR:isDefined(l)?getDefined(l.resFear,"0"):"0",remainStatPoint:getDefined(a.remainStatPoint,"0"),totalStatPoint:getDefined(e.totalStatPoint,"0"),remainElixirPoint:getDefined(e.targetElixir||e.totalElixirPoint,"0"),totalElixirPoint:getDefined(e.targetElixir||e.totalElixirPoint,"0"),elixirUseYN:getDefined(e.elixirUseYN,!1)};return console.log("-> StatModel.js getDefaultStatData : options.tota  lStatPoint/targetElixir/remainElixirPoint/totalElixirPoint : ",a.totalStatPoint,e.totalStatPoint,e.targetElixir,e.remainElixirPoint,e.totalElixirPoint),n}static getSavedStatData(t,e,a={idex:"",page:"",type:""}){let i=t,l=e,n=i.formattedSubStat,o=allOf(isDefined(i),isDefined(n))?n.attribute:null;console.log("-> StatModel.js getSavedStatData : savedSimulationStat, savedUserStatInfo, options : ",t,e,a);let s={idx:a.idx,page:a.page,type:a.type,classType:l.classId,targetLevel:l.targetLevel,classImageUrl:l.classImageUrl,level:i.level,HP:i.hp,MP:i.mp,STR:i.mainStat.STR,DEX:i.mainStat.DEX,INT:i.mainStat.INT,CON:i.mainStat.CON,WIS:i.mainStat.WIS,CHA:i.mainStat.CHA,DAMAGE_SHORT:getDefined(n.STR.damageShort,"0"),HIT_SHORT:getDefined(n.STR.hitShort,"0"),FATAL_SHORT:getDefined(n.STR.fatalShort,"0"),WEIGHT:getDefined(n.STR.weight,"0"),DAMAGE_WIZ:getDefined(n.INT.damageWiz,"0"),HIT_WIZ:getDefined(n.INT.hitWiz,"0"),FATAL_WIZ:getDefined(n.INT.fatalWiz,"0"),MB:getDefined(n.INT.mb,"0"),MP_MINUS:getDefined(n.INT.mpMinus,"0"),DAMAGE_LONG:getDefined(n.DEX.damageLong,"0"),HIT_LONG:getDefined(n.DEX.hitLong,"0"),FATAL_LONG:getDefined(n.DEX.fatalLong,"0"),AC:getDefined(n.DEX.ac,"0"),ER:getDefined(n.DEX.er,"0"),LEVELUP_MP_PLUS_MIN:getDefined(n.WIS.levelupMpPlus.min,"0"),LEVELUP_MP_PLUS_MAX:getDefined(n.WIS.levelupMpPlus.max,"0"),MP_RECOVER_TIC:getDefined(n.WIS.mpRecoverTic,"0"),MP_RECOVER_LIQUOR:getDefined(n.WIS.mpRecoverLiquor,"0"),MR:getDefined(n.WIS.mr,"0"),LEVELUP_HP_PLUS_MIN:getDefined(n.CON.hpPlus.min,"0"),LEVELUP_HP_PLUS_MAX:getDefined(n.CON.hpPlus.max,"0"),HP_RECOVER_TIC_MIN:getDefined(n.CON.hpRecoverTic.min,"0"),HP_RECOVER_TIC_MAX:getDefined(n.CON.hpRecoverTic.max,"0"),HP_RECOVER_LIQUOR:getDefined(n.CON.hpRecoverLiquor,"0"),CON_DAMAGE_MINUS:getDefined(n.CON.damageMinus,"0"),CON_RES_SKILL:getDefined(n.CON.resSkill,"0"),CON_RES_SUMMON:getDefined(n.CON.resSummon,"0"),CON_RES_DRAGON:getDefined(n.CON.resDragon,"0"),CON_RES_FEAR:getDefined(n.CON.resFear,"0"),CHA_HIT_SIKII:getDefined(n.CHA.hitSkill,"0"),CHA_HIT_SUMMON:getDefined(n.CHA.hitSummon,"0"),CHA_HIT_DRAGON:getDefined(n.CHA.hitDragon,"0"),CHA_HIT_FEAR:getDefined(n.CHA.hitFear,"0"),CHA_SKILL_TIME_REDUCTION:getDefined(n.CHA.skillTimeReduction,"0"),CHA_STATUS_TIME_REDUCTION:getDefined(n.CHA.statusTimeReduction,"0"),FIRE:isDefined(o)?getDefined(o.FIRE,"0"):"0",WATER:isDefined(o)?getDefined(o.WATER,"0"):"0",STORM:isDefined(o)?getDefined(o.STORM,"0"):"0",LAND:isDefined(o)?getDefined(o.LAND,"0"):"0",HIT_SKILL:isDefined(o)?getDefined(o.hitSkill,"0"):"0",RES_SKILL:isDefined(o)?getDefined(o.resSkill,"0"):"0",HIT_SUMMON:isDefined(o)?getDefined(o.hitSummon,"0"):"0",RES_SUMMON:isDefined(o)?getDefined(o.resSummon,"0"):"0",HIT_DRAGON:isDefined(o)?getDefined(o.hitDragon,"0"):"0",RES_DRAGON:isDefined(o)?getDefined(o.resDragon,"0"):"0",HIT_FEAR:isDefined(o)?getDefined(o.hitFear,"0"):"0",RES_FEAR:isDefined(o)?getDefined(o.resFear,"0"):"0",remainStatPoint:l.statPointInfo.remainStatPoint,totalStatPoint:l.statPointInfo.totalStatPoint,remainElixirPoint:l.statPointInfo.remainElixirPoint,totalElixirPoint:l.statPointInfo.totalElixirPoint,elixirUseYN:l.statPointInfo.usedElixir};return s}}class Stat{constructor(t){let e=this;if(isNotDefined(t))throw Error("Stat constructor require options object");e.option=$.extend({deviceType:"",wrap:null,staticDomain:"",apiDomain:"",isLogin:!1,global:window},t),e.model=StatModel.getInstance(),e.loading=SingletonLoading.getInstance(),e.wrap=null,e.simulatorWrap=null,e.classLayer=null,e.storageWrap=null,e.displayNoStorageItem=null,e.stat=null,e.global=e.option.global}init(){let t=this;if(t.wrap=$(t.option.wrap),notSingleEle(t.wrap))throw Error("wrap must be single element.");return t.model.DEVICE_TYPE=t.option.deviceType,t.simulatorWrap=$(".wrap-simulator",t.wrap),t.classLayer=$(".simulator-select",t.wrap),t.storageWrap=$(".simulator-storage",t.wrap),t.displayNoStorageItem=$(".nodata",t.wrap),t.setInstance(),t}setInstance(){this.setLoadingBar(),this.setBtns(),this.setClassLayer(),truthy(this.option.isLogin)&&this.setStorage()}setLoadingBar(){$(".wrap-contents",this.wrap).append(getLoadingBarTpl()),this.loading.setLoadingBar($(".loadingbar",this.wrap)),this.loading.end()}setBtns(){let t=this;$(".btn-simulator",t.wrap).on("click",function(e){if(e.preventDefault(),t.getSavedUserStatNum()>=t.model.USER_STAT_NUM_LIMIT){let a=t.global.confirm(ALERT.SAVE_STAT_LIMIT);truthy(a)&&(t.showClassLayer(!0),t.showStorage(!1))}else t.showClassLayer(!0),t.showStorage(!1)}),$(".btn-login",t.wrap).on("click",function(e){e.preventDefault(),isFunction(t.global.GNBLogin)&&t.global.GNBLogin()})}setClassLayer(){let t=this;$(".btn-close",t.classLayer).on("click",function(e){e.preventDefault(),t.showClassLayer(!1),t.showStorage(!0),$(".simulator-select-class-article ul li.is-selected").removeClass("is-selected"),$('.simulator-select-level-article input[name="targetElixir"]').val(""),$('.simulator-select-level-article input[name="targetLevel"]').val("")}),$("article ul li",t.classLayer).on("click",function(t){t.preventDefault(),$(".simulator-select-class-article ul li.is-selected").removeClass("is-selected"),$(this).addClass("is-selected")});let e=getElixirByLevel();document.querySelector('input[name="targetLevel"]').addEventListener("input",function(){let a=parseInt(this.value,10),i=document.querySelector('input[name="targetElixir"]');!isNaN(a)&&t.model.LEVEL_INIT<=a&&a<=t.model.LEVEL_MAX?i.placeholder=function t(a){let i=void 0!==e[a]?e[a]:0;return`${a} 레벨 캐릭터는 0 ~ ${i} 개의 엘릭서를 사용할 수 있습니다.`}(a):i.placeholder="입력한 레벨에 따라 엘릭서의 최대 사용 개수가 정해집니다."}),$('.simulator-select-level-article input[name="targetElixir"]',t.classLayer).on("keypress",function(e){"Enter"===e.key&&$(".simulator-select-level-button .btn-submit",t.classLayer).trigger("click")}),$(".simulator-select-level-button .btn-submit",t.classLayer).on("click",function(a){a.preventDefault();let i=$('.simulator-select-class-article ul li[class="is-selected"]').attr("data-class"),l=parseInt($('.simulator-select-level-article input[name="targetLevel"]').val(),10),n=parseInt($('.simulator-select-level-article input[name="targetElixir"]').val(),10),o=void 0!==e[l]?e[l]:0;if(!i)return alert("클래스를 선택해주세요."),!1;if(isNaN(l)||l<t.model.LEVEL_INIT||l>t.model.LEVEL_MAX){alert(`원하는 레벨을 ${t.model.LEVEL_INIT}~${t.model.LEVEL_MAX} 사이의 숫자로 입력해주세요.`),$('.simulator-select-level-article input[name="targetElixir"]').val("").blur(),$('.simulator-select-level-article input[name="targetLevel"]').val("").focus();return}if(isNaN(n)||n<0||n>o){alert(`엘릭서의 개수를 0~${o} 사이의 숫자로 입력해주세요.`),$('.simulator-select-level-article input[name="targetElixir"]').val("").focus();return}t.setClassDefaultStat(i,l,n)})}setStorage(){let t=this;t.setStorageItemsEvent(!1);let e=$(".storage-bundle",t.wrap);$(".storage__stat",e).remove(),truthy(t.loading.isLoading)||getSavedUserStats({apiDomain:t.option.apiDomain,beforeSend:()=>t.loading.start()}).then((a,i,l)=>{if(console.log("getSavedUserStat - data :",a),t.loading.end(),truthy(Array.isArray(a))){if(a.length>0){a.sort((t,e)=>new Date(e.updateDate).getTime()-new Date(t.updateDate).getTime());let n=null,o="";each(a,function(e){let a=getStatMaxByLevel(parseInt(e.targetLevel));for(let i in e.idx=e.idx,e.classId=e.classId,e.date=t.getDateStr(e.updateDate),e.hp=e.statMetaInfo.hp,e.mp=e.statMetaInfo.mp,n=e.statMetaInfo.mainStat)n[i]>a&&(n[i]=a);e.percentageSTR=`${n.STR/a*100}%`,e.percentageDEX=`${n.DEX/a*100}%`,e.percentageINT=`${n.INT/a*100}%`,e.percentageWIS=`${n.WIS/a*100}%`,e.percentageCON=`${n.CON/a*100}%`,e.percentageCHA=`${n.CHA/a*100}%`;let l=doT.template(getStatStorageItemTpl(!0)),s=l(e);o+=s}),e.prepend(o),t.setStorageItemsEvent(!0),t.showNoStorageItems(!1)}else t.showNoStorageItems(!0)}else t.global.alert(ALERT.FAIL_LOAD_SAVED_STAT)}).catch(e=>{t.loading.end(),falsy(handleApiError(e.jqXHR))&&t.global.alert(ALERT.FAIL_LOAD_SAVED_STAT)})}setClassDefaultStat(t,e,a){let i=this;truthy(i.loading.isLoading)||(console.log("-> Stat.js, setClassDefaultStat() 클래스/레벨/엘릭서 선택 classId/targetLevel/remainElixirPoint",t,e,a),getClassDefaultStat({apiDomain:i.option.apiDomain,classId:t,targetLevel:e,beforeSend:()=>i.loading.start()}).then(function(l,n,o){console.log("-> Stat.js, /default 응답후 받아서 초기데이타 출력 data: ",l),i.loading.end(),i.showSimulatorWrap(!1),i.showClassLayer(!1),console.log("-> Stat.js _.setStatSimulator()~  default, classId, targetLevel, targetElixir) : ",t,e,a),i.setStatSimulator("default",t,e,a,l)}).catch(function(t){i.loading.end(),falsy(handleApiError(t.jqXHR))&&i.global.alert(ALERT.FAIL_RESET)}))}setStorageItemsEvent(t){let e=this,a=$(".storage-bundle .storage__stat",e.wrap);a.each((a,i)=>{truthy(t)?$(i).on("click",function(t){if(t.preventDefault(),truthy(e.loading.isLoading))return;e.loading.start();let a=$(i).attr("data-class-id"),l=$(this).attr("data-idx"),n=$(this).attr("data-level"),o=$(this).attr("data-target-level");if($(t.target).hasClass("btn-delete")){if(allOf(isString(l),""!==l)){let s=ALERT.TRY_DELETE_STAT({level:n}),r=e.global.confirm(s);r?e.deleteStatSetting(l):e.loading.end()}return}e.setStatSimulatorByApi(a,o,l)}):$(i).off("click")})}deleteStatSetting(t){let e=this;deleteUserStat({apiDomain:e.option.apiDomain,idx:t,beforeSend:()=>e.loading.start()}).then((a,i,l)=>{e.loading.end(),"success"===a.result?($(".storage-bundle .storage__stat",e.option.wrap).filter(function(){return $(this).attr("data-idx")===t}).remove(),e.showNoStorageItems($("section article.storage__stat").length<1)):falsy(handleApiError(a))&&e.global.alert(ALERT.FAIL_DELETE_STAT)}).catch(t=>{e.loading.end(),falsy(handleApiError(jqXHR))&&e.global.alert(ALERT.FAIL_DELETE_STAT)})}async setStatSimulatorByApi(t,e,a){console.log("-> Stat.js, setStatSimulatorByApi() 저장한 스탯 콜");try{let i=await getClassDefaultStat({apiDomain:this.option.apiDomain,classId:t,targetLevel:e});console.log("-> Stat.js, setStatSimulatorByApi() classDefaultStat : ",i);let l=await getSavedUserStat({apiDomain:this.option.apiDomain,idx:a});console.log("-> Stat.js, setStatSimulatorByApi() savedUserStat : ",l),this.loading.end(),this.showSimulatorWrap(!1),this.showClassLayer(!1);let n=StatModel.getSavedStatData(l.simulationStat,l.userStatInfo,{idx:a,page:"view",type:this.model.DEVICE_TYPE});this.setStatSimulator(n.page,l.userStatInfo.classId,l.userStatInfo.targetLevel,l.userStatInfo.statPointInfo.totalElixirPoint,n,i)}catch(o){this.loading.end(),falsy(handleApiError(o.jqXHR))&&this.global.alert(ALERT.FAIL_LOAD_SAVED_STAT)}}setStatSimulator(t,e,a,i,l,n=null){let o=this;o.stat=new StatSimulator({staticDomain:o.option.staticDomain,apiDomain:o.option.apiDomain,classId:e,targetLevel:a,targetElixir:i,page:t,wrap:$(".wrap-simulator-body",o.wrap),data:l,classDefaultStatData:n,isLogin:o.option.isLogin,savedUserStatNum:o.getSavedUserStatNum()}).init(),console.log("-> Stat.js setStatSimulator() _.stat : ",o.stat),$(o.stat).on(StatSimulator.EVT_CLOSE,function(t){o.destroyStatSimulator(),o.showStorage(!0),o.showSimulatorWrap(!0)}).on(StatSimulator.EVT_SAVE_STAT_COMPLETE,function(t){o.destroyStatSimulator(),o.setStorage(),o.showStorage(!0),o.showSimulatorWrap(!0)}).on(StatSimulator.EVT_DELETE_STAT_COMPLETE,function(t){o.destroyStatSimulator(),o.setStorage(),o.showStorage(!0),o.showSimulatorWrap(!0)})}showSimulatorWrap(t){truthy(t)?this.simulatorWrap.show():this.simulatorWrap.hide()}showClassLayer(t){truthy(t)?this.classLayer.show():this.classLayer.hide()}showStorage(t){truthy(t)?this.storageWrap.show():this.storageWrap.hide()}showNoStorageItems(t){truthy(t)?this.displayNoStorageItem.show():this.displayNoStorageItem.hide(),truthy(t)?$(".simulator-storage footer").hide():$(".simulator-storage footer").show()}getDateStr(t,e="YYYY.MM.DD"){return moment(t).format(e)}getSavedUserStatNum(){return $(".storage-bundle .storage__stat",this.wrap).length}destroyStatSimulator(){let t=this;isDefined(t.stat)&&($(t.stat).off(StatSimulator.EVT_CLOSE).off(StatSimulator.EVT_SAVE_STAT_COMPLETE).off(StatSimulator.EVT_DELETE_STAT_COMPLETE),t.stat.destroy(),t.stat=null)}}jQuery,namespace("nc.lineage"),nc.lineage.statSetting=function(t){if(isNotDefined(t))throw Error("nc.lineage.statSetting require options object");return new Stat(t).init()};