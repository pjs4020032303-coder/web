/*!
 * project : init
 * author : LINOFFICE
 * 디바이스 환경 및 최초 스크립트 설정
 */ const windowObjects=[];isIngame&&!account&&(location.href="/login_ingame");const NGPBind=e=>{isLauncher&&!window.ngpBindObject&&void 0!==window.CefSharp&&window.CefSharp&&window.CefSharp.BindObjectAsync("ngpBindObject","ngpBindObject").then(e)},NGP={goTo(e){e&&e!==window.location.pathname&&(window.location.href=e)},logout(){if(windowObjects.length)for(var e of windowObjects)e.close();getDatas(["/define/logout"],e=>{window.ngpBindObject&&window.ngpBindObject.onLogout?window.ngpBindObject.onLogout():NGPBind(()=>{window.ngpBindObject.onLogout()})},e=>{window.ngpBindObject&&window.ngpBindObject.onLogoutFail?window.ngpBindObject.onLogoutFail():NGPBind(()=>{window.ngpBindObject.onLogoutFail()})})},onScript(callback){account&&account.firstChar&&eval(callback)},onRefresh(){window.location.reload()},onNavigation(e){window.ngpBindObject&&window.ngpBindObject.onNavigation?window.ngpBindObject.onNavigation(e):NGPBind(()=>{window.ngpBindObject.onNavigation(e)})},onMessage(e){window.ngpBindObject&&window.ngpBindObject.onMessage?window.ngpBindObject.onMessage(e):NGPBind(()=>{window.ngpBindObject.onMessage(e)})}},NGPIE={goTo(e){e&&e!==window.location.pathname&&(window.location.href=e)},logout(){if(windowObjects.length)for(var e of windowObjects)e.close();getDatas(["/define/logout"],e=>{window.external&&window.external.onLogout&&window.external.onLogout()},e=>{window.external&&window.external.onLogoutFail&&window.external.onLogoutFail()})},onScript(callback){account&&account.firstChar&&eval(callback)},onRefresh(){window.location.reload()},onNavigation(e){window.external&&window.external.onNavigation&&window.external.onNavigation(e)},onMessage(e){window.external&&window.external.onMessage&&window.external.onMessage(e)}};document.addEventListener("contextmenu",e=>e.preventDefault()),$("body").addClass(device),isPurple&&$("body").addClass("ncPurple");let header_main=null;class PurpleUserInfo{constructor(){this.setInstance()}setInstance(){if(this.el=document.createElement("div"),this.el.setAttribute("class","ncc-purple-bottom-nav"),account){let e=account.firstChar;this.el.innerHTML=`<div class="ncc-login--info"><a><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${e?e.profileUrl:"/img/user_unkown.jpg"}?${cacheVersion}" alt="" class="ncc-login--info__thumb"><span class="ncc-login--info__char">${e?e.name:`대표 케릭터 미설정`}</span><span class="ncc-login--info__server">${serverName}</span></a></div>`}document.querySelector("#nc-cnb").appendChild(this.el)}}let dim_singleton=null,dim_singletonEnforcer="singletonEnforcer";class Dimmed{constructor(e){if(e!==dim_singletonEnforcer)throw"Cannot--construct singleton";this.init()}static get instance(){return dim_singleton||(dim_singleton=new Dimmed(dim_singletonEnforcer)),dim_singleton}init(){this.dimmed=document.querySelector("#nc-cnb .ncc-dimmed"),this.dimmed||(document.querySelector("#nc-cnb").insertAdjacentHTML("beforeend",'<div class="ncc-dimmed"></div>'),this.dimmed=document.querySelector("#nc-cnb .ncc-dimmed")),["touchstart","touchmove","touchend"].forEach(e=>{this.dimmed.addEventListener(e,e=>{e.stopPropagation()})}),this.dimmed.addEventListener("click",e=>(this.openClose(!1),!1)),this.addEvents()}openClose(e=!0,t="left"){let s=document.querySelector("body");if(e){let n=document.querySelector(`.ncc-${t}-panel`);n&&n.classList&&n.classList.add("is-active"),this.dimmed&&this.dimmed.classList&&this.dimmed.classList.add("is-active-"+t),s.style.width="100%",s.style.position="fixed",s.style.marginTop=`-${s.scrollTop}px`}else{let i=document.querySelectorAll(".ncc-left-panel, .ncc-right-panel, .ncc-character-panel"),c=document.querySelector(".ncc-lnb-title--item");i&&i.forEach(e=>{e&&e.classList&&e.classList.remove("is-active")}),this.dimmed&&this.dimmed.classList&&this.dimmed.classList.remove(["is-active-left","is-active-right","is-active-title-submenu"]),c&&(c.style.display="none");let a=Math.abs(s.style.marginTop.replace("px",""));s.setAttribute("style",""),s.scrollTo(0,a)}e?s.classList&&s.classList.add("ncc-dimmed"):s.classList&&s.classList.remove("ncc-dimmed"),this.dimmed.dispatchEvent(new CustomEvent("open",{detail:{show:e,pos:t}}))}addEvents(){let e=this;e.leftOpen=document.querySelector(".ncc-ncservice-btn"),e.leftClose=document.querySelector(".ncc-left-panel-close"),e.rightOpen=document.querySelector(".ncc-login--after"),e.rightClose=document.querySelector(".ncc-right-panel-close"),e.leftOpen&&e.leftOpen.addEventListener("click",t=>{e.openClose(!0,"left")}),e.leftClose&&e.leftClose.addEventListener("click",t=>{e.openClose(!1,"left")}),e.rightOpen&&e.rightOpen.addEventListener("click",t=>{e.openClose(!0,"right")}),e.rightClose&&e.rightClose.addEventListener("click",t=>{e.openClose(!1,"right")})}}class SearchAutoSuggest{constructor(e){if(!e||(this.option=e,this.parent=document.querySelector(this.option.selector),!this.parent))return;this.loadedKeyword="",this.dataBaseKeyword="",this.isValueFunctionText="",this.apiUrl="/define/suggest",this.suggestWrap=this.parent.querySelector("[data-name='suggest_wrap']"),this.input=this.parent.querySelector("[data-name='suggest_input']"),this.submitBtn=this.parent.querySelector("[data-name='suggest_submit']"),this.deleteBtn=this.parent.querySelector("[data-name='suggest_delete']"),this.resultUL=this.parent.querySelector("[data-name='suggest_scroll'] ul"),this.REALTIME_INPUT_CHECK_INTERVAL=100,this.suggestWrap&&(this.suggestWrap.style.display="none"),this.deleteBtn&&(this.deleteBtn.style.display="none"),this.addEvents()}setInputValue(e){this.input&&(this.input.value=e)}getIndex(e){if(!e)return -1;let t=0;for(;e=e.previousElementSibling;)t++;return t}setDisplay(e,t){e&&(e.style.display=t?"block":"none")}load(e){if(this.loadedKeyword=e,!this.loadedKeyword)return;let t=encodeURIComponent(this.loadedKeyword),s=`SEARCH_AUTO_SUGGEST_LIST_${t}`,n=getSession(s),i=n?JSON.parse(n):null;if(null!=i&&void 0!=i){this.drawList(i);return}fetch(`${this.apiUrl}?query=${t}&page_size=${this.option.size}&type=${this.option.type?this.option.type:"0"}`,{method:"GET",credentials:"include"}).then(e=>e.json()).then(e=>{setSession(s,"object"==typeof e?JSON.stringify(e):e),this.drawList(e)}).catch(e=>console.log("::::::::::fail::::::::::",e))}addEvents(){let e=isIngame?"keypress":"keydown";this.input.addEventListener(e,e=>{let t=e.keyCode,s=[27,13,9,40,38];if(s.includes(t)){switch(t){case 27:this.setInputValue(this.loadedKeyword),this.suggestWrapToggle(!1);break;case 13:this.submitGo();break;case 9:this.focusChange(e.shiftKey?-1:1);break;case 40:this.focusChange(1);break;case 38:this.focusChange(-1)}return e.preventDefault(),!1}}),this.input.addEventListener("focusout",e=>{setTimeout(()=>this.suggestWrapToggle(!1),150),this.sto&&(clearTimeout(this.sto),this.sto=null)});let t=this.resultUL.querySelectorAll("li");this.input.addEventListener("focusin",e=>{this.isValueFunctionText="",this.sto||this.realTimeInputCheck(),t.length&&this.suggestWrapToggle(!0)}),this.submitBtn.addEventListener("click",e=>this.submitGo()),this.deleteBtn.addEventListener("click",e=>{this.loadedKeyword="",this.setInputValue(""),this.input.focus()}),this.listClickCallbackBind=this.listClickCallback.bind(this),this.listMouseOverCallbackBind=this.listMouseOverCallback.bind(this)}realTimeInputCheck(){this.sto&&(clearTimeout(this.sto),this.sto=null);let e=this.input.value,t=e.trim();t?this.loadedKeyword!==t&&this.dataBaseKeyword!==t&&this.isValueFunctionText!==t&&(this.load(t),this.isValueFunctionText=""):(""!=this.loadedKeyword&&setTimeout(()=>{this.input.value.trim()||(this.loadedKeyword="")},this.REALTIME_INPUT_CHECK_INTERVAL),this.resultUL.hasChildNodes()&&setTimeout(()=>{this.resultUL.innerHTML="",this.suggestWrapToggle(!1)},this.REALTIME_INPUT_CHECK_INTERVAL)),this.deleteBtnToggle(t),this.sto=setTimeout(()=>this.realTimeInputCheck(),this.REALTIME_INPUT_CHECK_INTERVAL)}deleteBtnToggle(e=""){if(!this.option.useDelbtn)return!1;e?this.deleteBtnIsShow||(this.deleteBtn&&(this.deleteBtn.style.display="block"),this.deleteBtnIsShow=!0):this.deleteBtnIsShow&&(this.deleteBtn&&(this.deleteBtn.style.display="none"),this.deleteBtnIsShow=!1)}drawList(e){if(!e||!this.input.value.trim())return;let t=e;this.suggestWrapToggle(t.length>0),this.listRemoveEvent();let s="";if(t.length){let n=RegExp(this.loadedKeyword,"i");s=t.map((e,t)=>{let s=n.exec(e),i=e.replace(s,`<mark>${s}</mark>`);return`<li data-idx="${t}" data-keyword="${e}">${i}</li>`}).join("")}this.resultUL&&(this.resultUL.innerHTML=s),this.listAddEvent()}listRemoveEvent(){this.parent.querySelectorAll("[data-name='suggest_scroll'] ul li").forEach(e=>{e.removeEventListener("click",this.listClickCallbackBind),e.removeEventListener("mouseover",this.listMouseOverCallbackBind)})}listAddEvent(){this.parent.querySelectorAll("[data-name='suggest_scroll'] ul li").forEach(e=>{e.addEventListener("click",this.listClickCallbackBind),e.addEventListener("mouseover",this.listMouseOverCallbackBind)})}listClickCallback(e){let t=e.currentTarget.dataset.keyword||"";this.setInputValue(t),this.submitGo()}listMouseOverCallback(e){let t=e.currentTarget,s=t.parentElement,n=s.querySelector("li.focus");n&&n.classList&&n.classList.remove("focus"),t&&t.classList&&t.classList.add("focus")}focusChange(e=1){let t=this.resultUL.querySelectorAll("li"),s=t.length,n=this.resultUL.querySelector(".focus"),i=this.getIndex(n)+(1===e?1:-1),c;c=t[i=i<0?s:i>s?0:i],n&&n.classList&&n.classList.remove("focus"),this.suggestWrapToggle(!!c),c&&(c.focus(),c.classList&&c.classList.add("focus"),this.dataBaseKeyword=c.dataset.keyword,this.setInputValue(this.dataBaseKeyword))}submitGo(){let e=this.input.value.trim();this.suggestWrapToggle(!1),""!==e&&(this.parent.action=this.option.action,this.parent.submit())}suggestWrapToggle(e=!0){this.setDisplay(this.suggestWrap,e),e||this.resultUL.querySelectorAll("li").forEach(e=>e.classList.remove("focus"))}changeAddParam(e){this.option.addParam=e}value(e){this.isValueFunctionText=e,this.setInputValue(e)}}class Search{constructor(){if(this.parent=document.querySelector(".ncc-search.ncc-search--right-pc"),!this.parent||(this.parent.innerHTML=this.template(),this.searchAutoSuggest=create_auto_suggest({selector:"#nccSuggestForm",size:5,action:"/search",useDelbtn:!0,type:"0"}),!this.searchAutoSuggest))return;this.init()}init(){this.showSearchBar=!1,document.querySelector(".ncc-search").addEventListener("click",e=>{e.stopPropagation()}),document.querySelectorAll(".ncc-search legend, .ncc-search-mobile__btn").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.showSearchField()})}),document.querySelector(".ncc-search-close").addEventListener("click",e=>(e.preventDefault(),this.hideSearchField(),!1)),this.domClickHandlerCall=e=>this.domClickHandler.call(this,e)}template(){return`<fieldset><legend>Search</legend><div class="ncc-search-wrap"><input class="ncc-search-close" type="button" value="취소" title="취소"><form id="nccSuggestForm" name="nccSuggestForm" onsubmit="return false;"><input id="nccSuggestInput" name="query" class="ncc-search-input" type="text" placeholder="통합검색" autocomplete="off" data-name="suggest_input"><a href="#none" class="ncc-search-input-delete" onclick="return false;" value="X" title="삭제" data-name="suggest_delete" style="display: none;"></a><input id="nccSuggestSubmit" class="ncc-search-submit" type="button" value="GO" title="검색" data-name="suggest_submit"><div id="nccSuggestWrap" class="ncc-suggest-list-wrap" data-name="suggest_wrap" style="display: none;"><div id="nccSuggestList" class="ncc-suggest-list" data-name="suggest_list"><div data-name="suggest_scroll"><ul></ul></div></div></div></form></div></fieldset>`}resetSearchField(){let e=document.querySelector(".ncc-search-input"),t=document.querySelector(".ncc-search-input-delete");e&&(e.value=""),t&&(t.style.display="none")}showSearchField(){if(this.showSearchBar)return;let e=document.querySelector(".ncc-search"),t=document.querySelector(".ncc-lnb"),s=document.querySelector(".ncc-search-input");e&&e.classList&&e.classList.add("is-active"),t&&t.classList&&t.classList.add("search-active"),s&&setTimeout(()=>{s.click(),s.focus()},300),this.domClickEvent("add"),this.showSearchBar=!0}hideSearchField(){let e=document.querySelector(".ncc-search"),t=document.querySelector(".ncc-lnb");e&&e.classList&&e.classList.remove("is-active"),t&&t.classList&&t.classList.remove("search-active"),this.resetSearchField(),this.domClickEvent("remove"),this.showSearchBar=!1}domClickEvent(e){"add"===e?document.addEventListener("click",this.domClickHandlerCall):document.removeEventListener("click",this.domClickHandlerCall)}domClickHandler(e){let t=document.querySelector("#nc-cnb"),s=e.target;t.contains(s)||this.hideSearchField()}}class Noti{constructor(){let e=this;e.data=account.alimList,e.is_notice=e.data&&e.data.length,e.is_sync=!1,e.wrap=document.querySelector(".ncc-right-panel-wrap .ncc-noti-wrap")}init(){let e=this;return e.setInstance(),e.addEvents(),e}setInstance(){let e=this,t="";t=e.is_notice?e.data.map((e,t)=>`<li class="on"><div class="wrapNotice"><a><p class="noticeMsg">${e.logContent}&nbsp;-&nbsp;${moment(new Date(e.insertTime)).format("YYYY-MM-DD")}</p><a class="notiDelBtn" data-id="${e.id}" title="삭제">삭제</a><div class="thumb"><img class="icon" src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/${"NSHOP_BUY"==e.type?30005:"COUPON_USE"==e.type?30001:"NCOIN_GIFT"==e.type?30002:"CASH_CHARGE"==e.type?27011:27009}.png?${cacheVersion}" alt="nickname"></div></a></div></li>`).join(""):`<li class="on"><div class="wrapNotice"><a href="javascript:;"><p class="noticeMsg">알림이 없습니다.</p><div class="thumb"><img class="icon" src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/27009.png?${cacheVersion}" alt="nickname"></div></a></div></li>`,e.wrap.innerHTML=`<ul class="ncc-noti-tab"><li class="is-active"><a onClick="return false;">알림 <span class="is-on" style="background-color: #dc4141; ${e.is_notice?"":"display: none;"}">${e.is_notice?e.data.length:0}</span></a></li><li><a>접속친구</a></li></ul><div class="ncc-noti"><div class="ncc-noti-list" id="notiList"><div class="wrap_btns"><button class="imgBtn btnSetting">알림설정</button></div><ul>${t}</ul></div><div class="ncc-noti-setting" id="notiSetting" style="display: none;"><header class="setAll"><input type="checkbox" id="-1" ${account.alimReceive?"checked":""}><label for="-1">알림받기</label><p class="desc">서버에서 보내는 알림을 받습니다.</p></header><div class="wrap_btns"><button class="imgBtn btnApply">확인</button>&nbsp;<button class="imgBtn btnCancel">취소</button></div></div></div>`}delete(e,t){let s=this;!s.is_sync&&(s.is_sync=!0,getDatasWithOption([{type:"POST",url:"/define/alim/delete",dataType:"json",contentType:"application/json",Accept:"application/json",data:{id:e}}],e=>{$(t).closest("li.on").remove(),e?$(".ncc-noti-tab span").text(e):($(".ncc-noti-tab span").css("display","none"),$("#notiList ul").append('<li class="on"><div class="wrapNotice"><a href="javascript:;"><p class="noticeMsg">알림이 없습니다.</p><div class="thumb"><img class="icon" src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/27009.png?${cacheVersion}" alt="nickname"></div></a></div></li>')),s.is_sync=!1},e=>{throw s.is_sync=!1,Error("noti delete from init.js Error")}))}setting(){let e=this,t=$("#notiSetting input[type=checkbox]").prop("checked");t!=account.alimReceive&&!e.is_sync&&(e.is_sync=!0,getDatasWithOption([{type:"POST",url:"/define/alim/setting",dataType:"json",contentType:"application/json",Accept:"application/json",data:{is_receive:t}}],s=>{s&&(account.alimReceive=t),e.is_sync=!1},t=>{throw e.is_sync=!1,Error("noti apply from init.js Error")}))}addEvents(){let e=this;e.notiList=document.querySelector("#notiList"),e.notiSetting=document.querySelector("#notiSetting"),e.notiSettingButton=document.querySelector("#notiList .wrap_btns .btnSetting"),e.notiApplyButton=document.querySelector("#notiSetting .wrap_btns .btnApply"),e.notiCancelButton=document.querySelector("#notiSetting .wrap_btns .btnCancel"),e.notiSettingButton.addEventListener("click",t=>{e.notiList.style.display="none",e.notiSetting.style.display=""}),e.notiApplyButton.addEventListener("click",t=>{e.setting(),e.notiSetting.style.display="none",e.notiList.style.display=""}),e.notiCancelButton.addEventListener("click",t=>{$("#notiSetting input[type=checkbox]").prop("checked",account.alimReceive),e.notiSetting.style.display="none",e.notiList.style.display=""}),$("#notiList .wrapNotice .notiDelBtn").on("click",function(t){e.delete($(this).attr("data-id"),$(this))})}}class Left{constructor(e){if(!e)return;let t=this;if(t.wrap=document.querySelector(".ncc-left-panel .ncc-lnb-list"),!t.wrap)return;t.setInstance(e)}setInstance(e){let t=this;$(".ncc-gnb-wrap").prepend('<div class="ncc-gnb-wrap__bg"></div><a class="ncc-ncservice-btn">Open<span><i></i><i></i><i></i></span></a><a class="ncc-bi" data-type="image" href="/" target="_self"><span>리니지</span></a>'),t.wrap.innerHTML=e,$(".ncc-left-panel .ncc-ncservice .ncc-ncservice-item-plaync a > span").text(serverName),$(".ncc-left-panel .ncc-lnb-item, .ncc-left-panel .ncc-lnb-item .ncc-lnb-item__sub > li").hover(function(){$(this).addClass("is-over")},function(){$(this).removeClass("is-over")})}}class Login{constructor(){let e=this;if(e.wrap=document.querySelector("#nc-cnb .is-child-nav .ncc-login"),!e.wrap)return;e.init()}init(){let e=this;if(!account){e.wrap.innerHTML=`<div class="ncc-login--before"><a class="ncc-login__link ncc-login__link-login">로그인</a><a class="ncc-login__link ncc-login__link-join">${serverName}</a></div>`,e.login=document.querySelector(".ncc-login--before .ncc-login__link-login"),e.login.addEventListener("click",e=>{login(),eventStop(e)});return}e.wrap.innerHTML=account.firstChar?`<div class="ncc-login--after"><div class="ncc-login--mobile"><button class="ncc-login--mobile-btn"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${account.firstChar.profileUrl}?${cacheVersion}" class="ncc-login--info__thumb"></button><span class="ncc-login--info__noti"></span></div><div class="ncc-login--info"><a><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${account.firstChar.profileUrl}?${cacheVersion}" class="ncc-login--info__thumb"><span class="ncc-login--info__char">${account.firstChar.name}</span><span class="ncc-login--info__server">${serverName}, ${account.firstChar.level}Lv</span></a></div></div>`:`<div class="ncc-login--after"><div class="ncc-login--mobile"><button class="ncc-login--mobile-btn"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/user_unkown.jpg?${cacheVersion}" class="ncc-login--info__thumb"></button><span class="ncc-login--info__noti"></span></div><div class="ncc-login--info"><a><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/user_unkown.jpg?${cacheVersion}" class="ncc-login--info__thumb"><span class="ncc-login--info__char">미설정</span><span class="ncc-login--info__server">${serverName}, 0Lv</span></a></div></div>`,e._right=new Right}}class Right{constructor(){let e=this;if(e.wrap=document.querySelector(".ncc-right-panel > .ncc-right-panel-wrap"),!e.wrap)return;e.init()}init(){let e=this;e.setInstance(),e.noti=new Noti().init(),e.addEvents()}setInstance(){let e=this,t=account.firstChar;if(e.wrap.innerHTML=`<div class="ncc-userinfo" style="background-image: url('https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${t?t.profileUrl:"https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/user_unkown.jpg"}?${cacheVersion}');"><a class="ncc-right-panel-close">Close</a><div class="ncc-profile is-nc-account"><div class="ncc-profile-wrap"><a class="ncc-profile-img ic-home" href="/account/mypage" target="_self"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${t?t.profileUrl:"https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/user_unkown.jpg"}?${cacheVersion}"></a><div class="ncc-profile-info"><span class="ncc-profile-info__char">${t&&0!=account.objId?t.name:`대표 케릭터 미설정`}</span><span class="ncc-profile-info__server">${serverName}</span><span class="ncc-profile-info__level">${t?t.level:0}Lv</span></div><div class="ncc-profile-links"><a class="ncc-profile-charchange">캐릭터 변경</a><a class="ncc-profile-logout">로그아웃</a></div></div><div class="nc-account-info"><p>${account.name}</p></div></div><nav class="ncc-shortcut"><strong class="blind">서비스 바로가기</strong><ul id="ncc-shortcut-list" class="ncc-shortcut-list ncc-shortcut-list-length4"><li class="ncc-shortcut-item"><a href="/account/mypage" class="ncc-shortcut-item__link"><i class="icon-shortcut icon-shortcut--mypage"></i><span class="desc" id="ncc-shortcut-databind-mypage">마이페이지</span></a></li><li class="ncc-shortcut-item"><a href="/goods" class="ncc-shortcut-item__link"><i class="icon-shortcut icon-shortcut--ncoin"></i><span class="desc" id="ncc-shortcut-databind-ncoin">${commaAdd(account.ncoin)}</span></a></li><li class="ncc-shortcut-item"><a href="javascript:openCouponPopup();" class="ncc-shortcut-item__link"><i class="icon-shortcut icon-shortcut--entercoupon"></i><span class="desc" id="ncc-shortcut-databind-entercoupon">쿠폰등록</span></a></li><li class="ncc-shortcut-item"><a href="/customer" class="ncc-shortcut-item__link"><i class="icon-shortcut icon-shortcut--cs"></i><span class="desc" id="ncc-shortcut-databind-cs">문의내역</span></a></li></ul></nav></div><div class="ncc-noti-wrap"></div>`,account.charList.length){let s=account.charList.map((e,t)=>`<li data-id="${e.objId}"><span>${e.name}</span></li>`).join("");$(".ncc-character-panel .ncc-character-list-wrap .ncc-character-list").html(s)}}mainCharacterChange(e){let t=document.createElement("form");t.setAttribute("charset","UTF-8"),t.setAttribute("method","POST"),t.setAttribute("action","/account/chageCharacter");let s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","redirect_uri"),s.setAttribute("value",window.location.href),t.appendChild(s);let n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","character_id"),n.setAttribute("value",e),t.appendChild(n),document.querySelector("body").appendChild(t),t.submit()}addEvents(){let e=this;e.logout=document.querySelector(".ncc-profile-wrap .ncc-profile-links .ncc-profile-logout"),e.logout.addEventListener("click",e=>{logout(),eventStop(e)}),e.characterPanel=document.querySelector(".ncc-character-panel"),e.characterPanel&&(e.characterOpen=document.querySelector("#nc-cnb .ncc-profile-charchange"),e.characterClose=document.querySelector("#nc-cnb .ncc-character-panel-close"),e.characterOpen.addEventListener("click",t=>(e.characterPanel.classList&&e.characterPanel.classList.add("is-active"),!1)),e.characterClose.addEventListener("click",t=>(e.characterPanel.classList&&e.characterPanel.classList.remove("is-active"),!1)),$(".ncc-character-list > li").on("click",function(t){if($(this).find("span").text()==$(".ncc-login--info__char").text())return e.characterPanel.classList&&e.characterPanel.classList.remove("is-active"),!1;let s=$(this).attr("data-id");if(!s)return!1;e.mainCharacterChange(s)}))}}class HeaderMain{constructor(e){if(!e||header_main)return;let t=this;if(t.cnb_wrap=document.querySelector("#nc-cnb"),!t.cnb_wrap)return;t.setInstance(),t._data=e,t.lnb_wrap=$(".ncc-lnb-wrap"),t.gnb_wrap=$(".ncc-gnb-wrap"),t._tpl_lnb=t.lnb(),isWeb&&(t._left=new Left(t._tpl_lnb)),isIngame||(t._login=new Login),t.search=new Search,t.dim=Dimmed.instance,t.addEvents()}setInstance(){let e=this;e.cnb_wrap.innerHTML=`<div class="ncc-header is-child-nav"><div class="ncc-gnb-wrap"><div class="ncc-search ncc-search--right-pc"></div><div class="ncc-login"></div></div><div class="ncc-lnb-wrap"></div></div><div class="ncc-left-panel"><div class="ncc-left-panel-wrap"><div class="ncc-left-panel-header"><div class="ncc-lnb-header-bi"><a href="/" class="ncc-bi" target="_self">리니지</a></div><div class="ncc-lnb-header-ncservice">plaync 서비스</div><a class="ncc-left-panel-close">Close</a></div><div class="ncc-left-panel-content scrollbar-macosx"><nav class="ncc-lnb-m"><ul class="ncc-lnb-list"></ul></nav><div class="ncc-ncservice"><ul class="ncc-ncservice-list"><li class="ncc-ncservice-item ncc-ncservice-item-plaync"><a href="/" class="plaync"><span></span></a></li></ul></div></div></div></div><div class="ncc-right-panel"><div class="ncc-right-panel-wrap scrollbar-macosx"></div></div><div class="ncc-character-panel"><div class="ncc-character-panel-wrap"><a class="ncc-character-panel-close">닫기</a><div class="ncc-character-panel-header">대표 캐릭터 선택</div><div class="ncc-character-list-wrap"><ul class="ncc-character-list"></ul></div></div></div>`,e.cnb_wrap.setAttribute("data-ncc-device",device),e.cnb_wrap.setAttribute("data-cnb-type","a"),e.cnb_wrap.setAttribute("data-theme","lineage")}lnb(){let e=this,t="";if(isWeb){let s="";$.each(e._data,(e,n)=>{let i="";$.each(n._subs,(e,t)=>{t.download&&(s=`<div class="ncc-gamestart"><div class="ncc-gamestart-btn"><a href="${t.href}" class="btn-download ncc-gamestart-btn__start">${t.desc}</a></div></div>`),i+=`<li class="s${t.id}"><a href="${t.href}" target="_self"><span>${t.desc}</span>${t.icon_external?'<em class="icon-external">popup</em>':""}${t.icon_new?'<em class="icon-new">N</em>':""}</a></li>`}),t+=`<li class="ncc-lnb-item m${n.id}"><a href="${n.href}"><span>${n.desc}</span>${n.icon_external?'<em class="icon-external">popup</em>':""}${n.icon_new?'<em class="icon-new">N</em>':""}</a><ul class="ncc-lnb-item__sub">${i}</ul></li>`}),e.lnb_wrap.html(`${s}<nav class="ncc-lnb"><ul class="ncc-lnb-list">${t}</ul><span class="ncc-lnb-hover" style="transform: translateX(50px) scaleX(0.1); opacity: 0;"></span></nav>`)}else $.each(e._data,(e,s)=>{let n="";$.each(s._subs,(e,t)=>{n+=`<li class="s${t.id}"><a href="${t.href}" target="_self"><span>${t.desc}</span>${t.icon_external?'<em class="icon-external">popup</em>':""}${t.icon_new?'<em class="icon-new">N</em>':""}</a></li>`}),t+=`<li class="ncc-lnb-item m${s.id}"><a href="${s.href}"><span>${s.desc}</span>${s.icon_external?'<em class="icon-external">popup</em>':""}${s.icon_new?'<em class="icon-new">N</em>':""}</a><ul class="ncc-lnb-item__sub">${n}</ul></li>`}),e.gnb_wrap.append(`<nav class="ncc-lnb-title" style="z-index:1;"><ul class="ncc-lnb-title--current">${t}</ul><div class="ncc-depth2-list-wrap" id="ncc-depth2-tap"><div class="ncc-depth2-scroller" style="display:inline-block;"><div class="ncc-depth2-list"></div></div></div></nav>`);return t}gnb(e,t){let s=this,n=$(".wrap-header .header .header-title").text(),i=$(".ncc-lnb-wrap .ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+e),c=i.children("a").attr("href"),a=i.children(".ncc-lnb-item__sub").children("li"),l="";$.each(a,function(e,t){l+=`<span class="ncc-depth2-list-items s${e+1}"><a href="${$(t).children("a").attr("href")}">${$(t).find("span").html()}</a></span>`}),s.gnb_wrap.append(`<nav class="ncc-lnb-title" style="z-index:1;"><p class="ncc-lnb-title--current"><a href="${c}">${n}</a></p><div class="ncc-depth2-list-wrap" id="ncc-depth2-tap"><div class="ncc-depth2-scroller" style="display:inline-block;"><div class="ncc-depth2-list">${l}</div></div></div></nav>`),$(".ncc-lnb-title .ncc-depth2-list .ncc-depth2-list-items.s"+t).addClass("selected"),$(".ncc-gnb-wrap .ncc-bi").css("display","none")}gnbIngame(e,t){if(void 0!==e){let s=$(".ncc-lnb-title .ncc-lnb-title--current .ncc-lnb-item.m"+e);s.addClass("is-active"),s.find(".ncc-lnb-item__sub > li.s"+t).addClass("is-active"),t&&$("#nc-cnb .ncc-lnb-title #ncc-depth2-tap").addClass("is-active")}$(".ncc-gnb-wrap .ncc-bi").css("display","none")}addEvents(){let e=this;e.ncc_lnb=document.querySelector(".ncc-lnb");let t=$(".ncc-lnb .ncc-lnb-list .ncc-lnb-item, .ncc-lnb-title .ncc-lnb-title--current .ncc-lnb-item"),s=$(".ncc-lnb .ncc-lnb-list .ncc-lnb-item .ncc-lnb-item__sub > li, .ncc-lnb-title .ncc-lnb-title--current .ncc-lnb-item .ncc-lnb-item__sub > li"),n=$("#nc-cnb .ncc-lnb-hover"),i=n.width()>>1,c=0,a=0,l="undefined"==typeof pageCnbType?void 0:pageCnbType,r="undefined"==typeof pageCnbSubType?void 0:pageCnbSubType,o=$("body").hasClass("page-main"),d=o&&e.ncc_lnb;if(o&&(d&&e.ncc_lnb.classList.add("ncc-lnb-type--main"),isWeb||(l=0)),isWeb){if(l){$(".ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+l).addClass("is-active");let h=$(".ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+l+" .ncc-lnb-item__sub > li.s"+r);h&&h.addClass("is-active"),c=h&&h.offset()?parseInt(h.offset().left+(h.width()>>1)-i,10):0,a=h&&h.offset()?h.length?(94*h.width()/100*.01*1.4).toFixed(2):.1:0,n.css({transform:`translateX(${c}px) scaleX(${a})`,opacity:"1"}),e.gnb(l,r)}}else e.gnbIngame(l,r);t.hover(function(){if(d&&e.ncc_lnb.classList.add("ncc-lnb-type--main-over"),t.removeClass("is-active"),$(this).addClass("is-over"),!isWeb){let s=$(this).find(".ncc-lnb-item__sub > li");s&&s.length>0&&$("#nc-cnb .ncc-lnb-title #ncc-depth2-tap").addClass("is-active")}},function(){d&&e.ncc_lnb.classList.remove("ncc-lnb-type--main-over"),$(this).removeClass("is-over"),void 0!==l&&($(".ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+l).addClass("is-active"),$(".ncc-lnb-title .ncc-lnb-title--current .ncc-lnb-item.m"+l).addClass("is-active")),isWeb||r||$("#nc-cnb .ncc-lnb-title #ncc-depth2-tap").removeClass("is-active")}),s.hover(function(){if(s.removeClass("is-active"),$(this).addClass("is-active"),isWeb){let e=parseInt($(this).offset().left+($(this).width()>>1)-i,10),t=$(this).length?(94*$(this).width()/100*.01*1.4).toFixed(2):.1;n.css({transform:`translateX(${e}px) scaleX(${t})`,opacity:"1"})}},function(){$(this).removeClass("is-active"),n.css("opacity","0"),l&&($(".ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+l+" .ncc-lnb-item__sub > li.s"+r).addClass("is-active"),$(".ncc-lnb-title .ncc-lnb-title--current .ncc-lnb-item.m"+l+" .ncc-lnb-item__sub > li.s"+r).addClass("is-active"),isWeb&&n.css({transform:`translateX(${c}px) scaleX(${a})`,opacity:"1"}),r&&!isWeb&&$(".ncc-lnb-title--current .ncc-lnb-item.m"+l+" .ncc-lnb-item__sub > li.s"+r).addClass("is-active"))}),$(window).scroll(function(){$(this).scrollTop()>100?e.cnb_wrap.classList&&e.cnb_wrap.classList.add("is-sticky"):e.cnb_wrap.classList&&e.cnb_wrap.classList.remove("is-sticky")}),$(".scrollbar-macosx").scrollbar()}}function create_auto_suggest(e){if(suggestEnable&&e)return new SearchAutoSuggest(e)}function createSessionConfig(e,t){switch(e){case"/notice/view":case"/update/view":case"/event/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"notice",type:t,list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/board/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"FREE",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/contents/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"CONTENTS",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/pitch/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"PITCH",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/goods/view":if("undefined"==typeof current_page_number)return;setSession("PAGINATION_INFINITE_LIST",JSON.stringify(paginationInfiniteList={page_type:"goods",page_number:current_page_number,scroll_Y:window.scrollY}))}}function urlform(e,t,s){createSessionConfig(s);var n=document.createElement("form");if(n.setAttribute("charset","UTF-8"),n.setAttribute("method",t),n.setAttribute("action",s),void 0!=e&&null!=e&&"null"!=e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","num"),i.setAttribute("value",e),n.appendChild(i)}document.body.appendChild(n),n.submit()}function urlTypeform(e,t,s,n){createSessionConfig(n,e);var i=document.createElement("form");if(i.setAttribute("charset","UTF-8"),i.setAttribute("method",s),i.setAttribute("action",n),void 0!=e&&null!=e&&"null"!=e){var c=document.createElement("input");c.setAttribute("type","hidden"),c.setAttribute("name","type"),c.setAttribute("value",e),i.appendChild(c)}if(void 0!=t&&null!=t&&"null"!=t){var c=document.createElement("input");c.setAttribute("type","hidden"),c.setAttribute("name","num"),c.setAttribute("value",t),i.appendChild(c)}document.body.appendChild(i),i.submit()}function urlQueryform(e,t,s){var n=document.createElement("form");if(n.setAttribute("charset","UTF-8"),n.setAttribute("method",t),n.setAttribute("action",s),void 0!=e&&null!=e&&"null"!=e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","query"),i.setAttribute("value",e),n.appendChild(i)}document.body.appendChild(n),n.submit()}function login(){var e=document.createElement("form");e.setAttribute("charset","UTF-8"),e.setAttribute("method","post"),e.setAttribute("action",isIngame?"/login_ingame":"/login");var t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","urlType"),t.setAttribute("value",window.location.href),e.appendChild(t),document.body.appendChild(e),e.submit()}function loginIngame(){var e=document.createElement("form");e.setAttribute("charset","UTF-8"),e.setAttribute("method","post"),e.setAttribute("action","/login_ingame");var t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","urlType"),t.setAttribute("value",window.location.href),e.appendChild(t),document.body.appendChild(e),e.submit()}function logout(){location.href="/account/logout"}function ingameCustomBrowser(){isIngame&&"customBrowser"!==window.name&&(openPopup(window.location.href,800,650,"customBrowser",1,0,!1,!0),$("body").html('<div id="customForm"><h1 style="text-align: center;">새롭게 생성된 임시 브라우저에서 이용하십시오.</h1></div>'))}function openPopup(e,t,s,n,i,c,a,l,r){if(isIngame)return location.href=e,null;try{if(1!==i&&0!==i&&"1"!==i&&"0"!==i){var o=i;i=n,n=o}if(navigator.platform.toUpperCase().indexOf("MAC")>=0)var d=s+22;else var d=s;if("string"==typeof e){var h="width="+t+",height="+s+", innerHeight="+d+",toolbar=no,location=no,status=no,menubar=no,top=20,left=20,scrollbars="+i+",resizable=no";""!=n&&n||(n="popup"),a&&(h="fullscreen=1,scrollbars=0");var p=window.open(e,n,h);return null!=p&&p.focus(),l&&windowObjects.push(p),p}n||(n="popup"),i||(i="auto");var u=r?e.href+"?"+r:e.href,h="width="+t+",height="+s+", innerHeight="+d+",toolbar=no,location=no,status=no,menubar=no,top=20,left=20,scrollbars="+i+",resizable=no";a&&(h="fullscreen=1,scrollbars=0");var p=window.open(u,n,h);return c&&(null==p?alert("팝업 차단을 해제하여 주시기 바랍니다."):p.focus()),l&&windowObjects.push(p),p}catch(g){}}function get_account_from_launcher(){let e={NCOIN:account?commaAdd(account.ncoin):0,NPOINT:account?commaAdd(account.npoint):0};return e}function showError(e,t,s){let n=`<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/css/error.css?${cacheVersion}"><div class="error-container" id="container"><div class="logo"><a class="logo-link" href="/"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/plaync.png?${cacheVersion}" alt="plaync icon"/></a></div><div class="error-contents-wrap"><header class="error-header"><h1 class="title">일시적으로 페이지를 불러올 수 없습니다.</h1><p class="subcopy">동일한 문제가 지속적으로 발생할 경우, 고객지원으로 문의해 주시기 바랍니다.</p></header><div class="error-contents"><div class="error-btn-wrap"><button class="btn btn-error btn-error--o btn-back" onclick="history.go(-1);">이전 페이지</button><a href="/customer" class="btn btn-error btn-inquiry">고객지원</a></div><div class="links"><a href="/"><span>홈</span></a></div></div></div><footer id="footer" class="error-footer-wrap"><p class="copyright">Ⓒ ${serverName} Corporation. All Rights Reserved.</p></footer></div>`;throw $("body").html(n),Error("init setting from init.js Error")}$(function(){if(!isPurple){let e=document.querySelector(".wrap-footer");e&&(e.innerHTML=`<div class="footer footer-kr"><div class="footer-links"><ul class="footer-links-list footer-links-list-kr"><li class="footer-links-items item1">${serverName}</li></ul></div><div class="footer-copyright"><div class="copyright-studio">Lineage \xae is a registered trademark of ${serverName} Corporation.</div><div class="copyright-company">Copyright \xa9 ${serverName} Corporation. <br> <span class="reserved">All Rights Reserved.</span></div></div><div class="footer-logo">${serverName}</div></div>`)}let t=document.querySelector("#layer_alert");t&&(t.innerHTML=`<div class="wrapper"><div class="btn_close close">close</div><div class="header">알림</div><div class="conWrap"><div class="con"></div></div><div class="btn_modal"></div></div>`),isPurple?new PurpleUserInfo:header_main=new HeaderMain(cnb)}),window.onunload=function(){if(windowObjects.length)for(var e of windowObjects)e.close()};