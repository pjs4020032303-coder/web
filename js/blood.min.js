/*!
 * project : blood
 * author : LINOFFICE
 * 혈맹
 */ let blood_singleton=null,blood_singletonEnforcer="singletonEnforcer";class Blood{constructor(s){if(s!==blood_singletonEnforcer)throw"Cannot--construct singleton";this.init()}static get instance(){return blood_singleton||(blood_singleton=new Blood(blood_singletonEnforcer)),blood_singleton}init(){let s=this;s.parmaeter={query:"",sortType:0},s.wrap=$(".table-list"),s.container=$(".pagination"),s.loader=$(".data-loader"),s.setInstance(),s.addEvents()}setInstance(){let s=this;s.loader.css("display","block"),s.container.pagination({dataSource:function(t){getDatasWithOption([{type:"POST",url:"/define/pledge",dataType:"json",contentType:"application/json",Accept:"application/json",data:s.parmaeter}],s=>{if(s){if(account&&account.firstChar&&account.firstChar.pledge){let e=`<h2><strong>내혈맹</strong></h2><div class="detail-info"><div class="blood-title"><span class="blood-icon"><i class="icon-pledge"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43 41"><path fill="#C69C7C" d="M36.797 6.243c-.523-.561-1.446-.29-1.446-.29-4.355.54-7.672-.004-10.167-.984-3.122-1.227-4.954-3.14-5.92-4.47a1.191 1.191 0 0 0-1.898-.053c-1.9 2.351-6.699 6.61-15.991 5.504A1.213 1.213 0 0 0 .017 7.118C-.133 11.43.318 28.484 17.994 40c3.39-1.786 6.531-4.488 8.794-6.741 5.662-5.638 8.146-12.278 9.203-17.62 0 0 1.552-8.595.806-9.396" mask="url(#b)"></path><path fill="#FFF" d="M28.878 27.143l.002-.003.01-.014c.078-.122.168-.345.061-.434-.115-.096-.264.023-.4.13l-.114.086c-1.077.746-2.079 1.066-3.189 1.107-1.373.04-2.244-.346-2.39-1.06-.046-.223.036-.716.097-.975a8.704 8.704 0 0 0 .123-3.375c-.388-2.268-1.545-4.091-2.475-5.555l-.211-.333c-.311-.501-.861-1.515-.889-1.617l-.002-.007-.004-.012c-.313-.664-.266-.984-.172-1.134a.344.344 0 0 1 .252-.159s.174-.02.32.039c.047-.249-.087-.39-.087-.39-.23-.237-.574-.408-.704-.472l-.028-.013c-.809-.413-2.736-.933-3.833-.951-.11 0-.2-.013-.233.057-.03.064.006.2.012.226.344 1.587.71 2.718 3.776 5.8.076.073.462.47.726.753.48.53 1.946 2.148 2.243 3.253.479 1.754-.824 4.385-2.326 6.214-.365.444-.524.773-.487 1.008.024.15.12.225.19.27.267.183 2.46.601 5.692-.257.049-.01.306-.074.336-.082 2.367-.683 3.336-1.61 3.704-2.1"></path></svg></i></span><span class="blood-name"><strong class="name">${account.firstChar.pledge.name}</strong></span></div><div class="blood-info"><ul><li><span>혈맹군주</span><strong class="leader">&nbsp;&nbsp;&nbsp;&nbsp;${account.firstChar.pledge.leader_name}</strong></li><li><span>혈맹원수 (최근/전체)</span><strong><strong class="count">${account.firstChar.pledge.member_size}</strong>/50명</strong></li></ul><ul><li><span>혈맹공헌도</span><strong><strong class="exp">${commaAdd(account.firstChar.pledge.contribution)}</strong>P</strong></li><li><span>아지트</span><strong class="has">${account.firstChar.pledge.castle_desc?account.firstChar.pledge.castle_desc:account.firstChar.pledge.agit_desc}</strong></li></ul></div></div>`;$(".wrap-detail-info").html(e)}else $(".wrap-detail-info").remove()}t(s)},s=>{throw Error("render from blood.js Error")})},pageSize:20,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(t,e){let n="";if(t.length){var a=account&&account.ingame;$.each(t,function(s,t){n+=`<div class="tr"><div class="td-row"><span class="td-blood">${t.name}</span><span class="td-master">${t.leader_name}</span><span class="td-member">${t.member_size}/50명</span></div><div class="td-row"><span class="td-point"><strong>${commaAdd(t.contribution)}</strong>P</span><span class="td-azit">${t.castle_desc?t.castle_desc:t.agit_desc}</span><span class="td-join">${a?t.join_button:""}</span></div></div>`})}else n=`<div class="nodata"><p>혈맹 정보가 존재하지 않습니다.</p></div>`;s.wrap.html(n),s.loader.css("display","none")}})}addEvents(){let s=this,t=$(".section-blood-list.section-blood-info > .tab > li"),e=$("#suggestInput"),n=$(".icon-delete"),a=$("#suggestSubmit");t.on("click",function(e){let n=$(this).children("a").attr("data-sort-type");s.parmaeter.sortType!==n&&(s.parmaeter.sortType=n,t.removeClass("active"),$(this).addClass("active"),s.setInstance())}),e.keyup(function(t){let a=e.val().length;n.css("display",a?"":"none"),13===t.keyCode&&(s.parmaeter.query=a?e.val():"",s.setInstance())}),n.on("click",function(s){e.val(""),n.css("display","none"),e.focus()}),a.on("click",function(t){let n=e.val().length;s.parmaeter.query=n?e.val():"",s.setInstance()})}}Blood.instance;