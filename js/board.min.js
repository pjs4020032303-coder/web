/*!
 * project : board
 * author : LINOFFICE
 * 게시판
 */ function get_board_uri_flag(){switch(boardType){case"CONTENTS":return"/contents";case"PITCH":return"/pitch";default:return"/board"}}function get_report_flag(){switch(boardType){case"CONTENTS":return"컨텐츠공모_ID_";case"PITCH":return"홍보_ID_";default:return"게시글_ID_"}}function commentLengthCheck(a){$(a).val().length>300&&$(a).val($(a).val().substr(0,300)),$(".count-word > em").text($(a).val().length)}function reportBtn(a){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(a),get_report_flag()+$(a).attr("data-boardid"))}function commentReportBtn(a){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(a),get_report_flag()+$(a).attr("data-boardid")+"_코멘트_ID_"+$(a).attr("data-commentid"))}function reportModalOpen(a,e){$("#ncCommunityReport .report-target .target").html(a.attr("data-name")),$("#reportLog").val(e),$("#ncCommunityReportModal").addClass("is-active"),$("#ncCommunityReport").addClass("is-active")}function reportModalClose(){$("#ncCommunityReportModal").removeClass("is-active"),$("#ncCommunityReport").removeClass("is-active")}function reportInsert(a){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let e=$("input:radio[name=reportCase]:checked").val(),t=$("#reportLog").val(),s=$("#ncCommunityReport .report-target .target").html();getDatasWithOption([{type:"POST",url:"/define/report/insert",dataType:"json",contentType:"application/json",Accept:"application/json",data:{targetName:s,type:e,log:t}}],a=>{popupShow(a,'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),reportModalClose()},a=>{throw Error("reportInsert from board.js Error")})}function likeBtn(a){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(a),"/define/board/like",{board_type:boardType,id:$(a).attr("data-id")})}function commentLikeBtn(a){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(a),"/define/board/commentLike",{board_type:boardType,id:$(a).attr("data-commentid"),boardnum:$(a).attr("data-boardnum")})}function boardLikeBtn(a,e,t){getDatasWithOption([{type:"POST",url:e,dataType:"json",contentType:"application/json",Accept:"application/json",data:t}],e=>{var t=Number($(a).find("em").html())+Number(e);$(a).find("em").html(t),1==e?$(a).addClass("is-active"):-1==e&&$(a).removeClass("is-active")},a=>{throw Error("boardLikeBtn from board.js Error")})}function boardCommentWrite(){var a=$(".comment-form-textarea > textarea");if(!a.val().length){popupShow("댓글을 작성해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let e=$("#ncCommunityView").attr("data-board-id"),t=$("#ncCommunityView").attr("data-board-num"),s={board_type:boardType,content:a.val(),boardId:e};getDatasWithOption([{type:"POST",url:"/define/board/commentInsert",dataType:"json",contentType:"application/json",Accept:"application/json",data:s}],e=>{if(e){var s=`<div class="comment-article" data-commentid="${e.id}"><div class="comment-info"><span class="thumb"><img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web${e.profileUrl}" alt=""></span><span class="writer">${e.name}<span class="server">${serverName}</span></span><span class="date">${moment(new Date(e.date)).format("YYYY. MM. DD. HH:mm:ss")}</span><button class="co-btn btn-declare" data-commentid="${e.id}" data-boardnum="${t}" data-name="${e.name}" aria-label="신고" onClick="commentReportBtn(this);">&nbsp;신고</button><button class="co-btn btn-delete" aria-label="삭제" onClick="deleteComment(this, ${e.id});">&nbsp;삭제</button></div><div class="comment-contents">${e.content}</div><div class="comment-utils"><button data-commentid="${e.id}" data-boardnum="${t}" class="co-btn co-btn-like" aria-label="좋아요수" onClick="commentLikeBtn(this);"><svg class="fe-svg fe-svg-like_s" style="width: 16px; height: 16px; vertical-align: middle; fill: rgba(0,0,0,.45)!important; color: rgba(0,0,0,.45)!important;"><use xlink:href="#fe-svg-like_s"></use></svg>&nbsp;<em class="text">${e.likenames?e.likenames.length:0}</em></button></div></div>`;$(s).appendTo(".commentThread"),$(".comment-article-none").remove(),a.val("");var n=$(".commentTotalCount");n.html(Number(n.html())+1)}else popupShow("고객님께서는 계정 또는 대표캐릭터 미설정 상태거나 이용제한 상태입니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},a=>{throw Error("boardCommentWrite from board.js")})}function deleteComment(a,e){popupShow(`댓글을 삭제하시겠습니까?`,`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:deleteCommentAction(${e});" class="close">예</a></span>`)}function deleteCommentAction(a){getDatasWithOption([{type:"POST",url:"/define/board/commentDelete",dataType:"json",contentType:"application/json",Accept:"application/json",data:{board_type:boardType,id:a}}],e=>{if(e){var t=$(".comment-article");$(t).each(function(e,s){t.eq(e).attr("data-commentid")==a&&s.remove()}),popupClose();var s=$(".commentTotalCount");s.html(Number(s.html())-1),0>=Number(s.html())&&$(".commentThread").html('<div class="comment-article-none"><p>첫 댓글을 남겨주세요.</p></div>')}else popupShow("댓글 삭제에 실패하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},a=>{throw Error("deleteCommentAction from board.js Error")})}$(function(){includeHTML(document.querySelector("#svg-container"),"https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/svg.html",cacheVersion);var a=$(".ui-dropdown"),e=$(".ui-dropdown-custom_items"),t=$(".co-btn-reset"),s=$(".btn-list"),n=$(".btn-cards"),o=$(".ncCommunityBoardList"),r=$(".co-btn-top_list"),i=$(".btn-type-selected");a.on("click",function(a){$(this).toggleClass("is-active")}),e.on("click",function(a){var e=$(this).attr("data-textvalue");$(".ui-dropdown-community.is-active .select").find("span").html(e),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),t.on("click",function(a){$("#ncCommunitySearch").val("")});var l=function(a){if($(".co-btn").removeClass("is-disabled"),"card"==a){s.addClass("is-disabled"),o.hasClass("board-list-default")&&o.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),i.removeClass("list"),i.addClass("card");var e="<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>";i.html(e),i.removeClass("is-show")}else{n.addClass("is-disabled"),o.hasClass("board-list-card")&&o.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),i.removeClass("card"),i.addClass("list");var e="<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>";i.html(e),i.removeClass("is-show")}};let c="board_free_viewMode";switch(boardType){case"CONTENTS":c="board_content_viewMode";break;case"PITCH":c="board_fitch_viewMode"}s.on("click",function(a){o.hasClass("board-list-card")&&(l("list"),setLocal(c,"list"))}),n.on("click",function(a){o.hasClass("board-list-default")&&(l("card"),setLocal(c,"card"))}),"card"===getLocal("board_free_viewMode")&&l("card"),r.on("click",function(a){document.body.scrollTop=0,document.documentElement.scrollTop=0,$(".ncPurple .container").animate({scrollTop:0},300)}),i.on("click",function(a){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(a){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(a){$("#wrapSearch").removeClass("is-show")}),$(".contentWrite").on("click",function(a){$(this).closest(".comment-form-contentWrite").hasClass("is-active")||(eventStop(a),location.href="/login")}),$(".comment-toolbar > .right > button").on("click",function(a){boardCommentWrite()}),$("#ncCommunityReport .ly-close").on("click",function(a){reportModalClose()}),$("#ncCommunityReport .co-btn-finish").on("click",function(a){reportInsert($(this))}),$("body").mouseup(function(a){!$(".option").has(a.target).length&&!$(".ui-dropdown.is-active").has(a.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(a.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(a)});var p=$(".nowCheckvalue");p&&p.length&&$.each(p,function(a,e){if(!e.value){var t=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(t)}})});let more_btn_lock=!1;function boardMore(){if(more_btn_lock||parameter.total_size<=0)return;let a=$(".nc-community-loader");a.css("display",""),more_btn_lock=!0,getDatasWithOption([{type:"POST",url:"/define/board/more",dataType:"json",contentType:"application/json",Accept:"application/json",data:parameter}],e=>{let t="";$.each(e,function(a,e){t+=createBoardHtml(e)}),$(t).appendTo(".ncCommunityBoardList"),e.length>0&&(parameter.current_num+=e.length,parameter.total_size-=e.length,parameter.total_size<=0&&$(".wrap-community-more").html("")),a.css("display","none"),more_btn_lock=!1},e=>{throw a.css("display","none"),more_btn_lock=!1,Error("boardMore from board.js Error")})}function createBoardHtml(a){var e=$(".ncCommunityBoardList"),t="",s="display:none;";e.hasClass("board-list-card")&&(t="display:none;",s="");let n=get_board_uri_flag(),o=`<span class="writer">${a.type?'<img src="https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/lineage_writer.png" alt="">':`${a.name}<span class="server">${serverName}</span>`}</span>&nbsp`,r=`<span class="date">${moment(new Date(a.date)).format("YY.MM.DD.")}</span>&nbsp`,i=moment().format("YYYYMMDD"),l=moment(new Date(a.date)).format("YYYYMMDD"),c=i-l,p=`${"CONTENTS"==boardType?`<span class="category">컨텐츠&nbsp;</span>`:"PITCH"==boardType?`<span class="category">홍보&nbsp;</span>`:""}`,d=`<span class="count-like" data-count="${a.likenames?a.likenames.length:0}">&nbsp;<svg class="fe-svg fe-svg-like_s"><use xlink:href="#fe-svg-like_s"></use></svg><em>${a.likenames?a.likenames.length:0}</em></span>`,m=`<span class="count-comment" data-count="${a.answerList?a.answerList.length:0}">&nbsp;<svg class="fe-svg fe-svg-comment"><use xlink:href="#fe-svg-comment"></use></svg><em>${a.answerList?a.answerList.length:0}</em></span>`;return`<li class="board-items" onClick='urlform("${a.rownum}", "post", "${n}/view");'><div class="title board-type-list" style="${t}">`+p+`<a href='javascript:urlform("${a.rownum}", "post", "${n}/view");'>${a.title}</a>${a.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':""}`+`<div class="count">${d}${m}</div>${0===c?'&nbsp<i class="fe-icon-new" data-diff=""></i>':""}`+"</div>"+`<div class="info board-type-list" style="${t}">`+o+r+`<span class="hit"><em class="txt">조회</em>${a.readcount}</span>`+`<span class="like">추천<em>${a.likenames?a.likenames.length:0}</em></span>`+"</div>"+`<div class="comment"><a href='javascript:urlform("${a.rownum}", "post", "${n}/view");'><span><em class="number">${a.answerList?a.answerList.length:0}</em><em class="txt">댓글</em></span></a></div>`+`<div class="board-type-card" style="${s}">`+`${a.mainImg?`<div class="board-items-thumb"><a href="javascript:urlform("${a.rownum}", "post", "${n}/view");"><img src="${a.mainImg}" alt=""></a></div>`:""}`+'<div class="board-items-contents"><div class="title">'+p+`<a href='javascript:urlform("${a.rownum}", "post", "${n}/view");'>${a.title}${0===c?'&nbsp<i class="fe-icon-new"></i></a>':"</a>"}`+"</div>"+`<div class="desc desc-overflow"><a href='javascript:urlform("${a.rownum}", "post", "${n}/view");'>${a.content}</a></div>`+o+'</div><div class="board-items-footer">'+`<div class="info"><span class="writer">${a.name}</span>${r}<span class="hit-count"><span class="txt">조회 </span><em>${a.readcount}</em></span></div>`+`<div class="count">${d}${m}</div>`+"</div></div></li>"}function boardFormSubmit(){let a=document.boardWriteForm;if(!a.title.value){popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!a.content.value){popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}if(!maxByteCheck(a.content.value,1))return;let e={board_type:boardType,title:a.title.value,content:a.content.value,images:Editor.images};a.rownum&&(e.rownum=a.rownum.value),getDatasWithOption([{type:"POST",url:a.action,dataType:"json",contentType:"application/json",Accept:"application/json",data:e}],a=>{a?(Editor.instance.setSubmit(),location.href=get_board_uri_flag()):popupShow("등록 또는 수정에 실패 하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},a=>{throw Error("boardFormSubmit from board.js Error")})}function delectConfirm(a){popupShow(`정말로 삭제하시겠습니까?`,`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:deleteConfirmAction(${a});" class="close">예</a></span>`)}function deleteConfirmAction(a){let e={board_type:boardType,rownum:a};getDatasWithOption([{type:"POST",url:"/define/board/delete",dataType:"json",contentType:"application/json",Accept:"application/json",data:e}],a=>{a?location.href=get_board_uri_flag():popupShow("삭제에 실패 하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},a=>{throw Error("deleteConfirmAction from board.js Error")})}