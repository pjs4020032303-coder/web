/*!
 * project : editor
 * author : LINOFFICE
 * 서머노트 편집기
 */ let editor_singleton=null,editor_singletonEnforcer="singletonEnforcer";class Editor{constructor(e){if(e!==editor_singletonEnforcer)throw"Cannot--construct singleton"}static get instance(){return editor_singleton||(editor_singleton=new Editor(editor_singletonEnforcer)),editor_singleton}static get images(){return editor_singleton.images}init(e,t){let i=this;i.is_insert=e,i.images=t||[],i.editor=$("#summernote"),i.create_editor(),i.create_emoticon(),i.is_submit=!1,i.addEvents()}create_editor(){let e=this;e.editor.summernote({height:500,minHeight:null,maxHeight:null,focus:!1,lang:"ko-KR",placeholder:"내용",tabDisable:!0,toolbar:[["style",["style"]],["fontstyle",["bold","underline","color"]],["paragraph",["paragraph","height","ul","ol"]],["insert",["link","table","picture","video"]],["custom",["emoticon"]]],buttons:{emoticon(){let t=$.summernote.ui;return t.button({contents:'<i class="xi-emoticon-smiley-o">',tooltip:"이모티콘",click:function(){e.show_emoticon()}}).render()}},callbacks:{onImageUpload:function(t,i,c){e.image_upload(t)}}})}create_emoticon(){let e=this,t=["https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_01.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_02.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_03.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_04.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_05.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_06.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_07.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_09.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_10.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_11.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_12.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_13.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char2_14.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_01.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_02.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_03.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_04.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_05.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_06.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_07.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_08.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_09.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_10.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_11.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_12.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char3_13.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_01.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_02.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_03.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_04.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_05.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_06.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_07.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_08.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_09.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_10.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_11.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_12.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_13.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_14.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_15.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_16.png","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_01.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_02.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_03.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_04.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_05.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_06.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_07.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_08.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_09.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_10.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_11.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_12.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_13.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_14.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_15.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/char9_v2_16.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_001_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_002_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_003_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_004_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_005_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_006_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_007_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_008_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_009_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_010_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_011_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_012_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_013_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_014_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_015_x3.gif","https://cdn.jsdelivr.net/gh/pjs4020032303-coder/web/img/emoticon/emot_016_x3.gif"].map((e,t)=>`<li class="emoticon-items"><img src="${e}" class="fe-emoticon" data-emoticon="true" alt=""></li>`).join("");$(".note-editor.note-frame.panel.panel-default").append(`<div id="emoticonLayer1" aria-hidden="false" tabindex="-1" role="dialog" aria-label="이모티콘" class="editor-layer-emoticon"><div class="editor-layer-header"><h2 class="editor-layer-title">이모티콘</h2><button type="button" class="fe-btn fe-btn-close"><i class="editor-icon-close"></i></button></div><div class="editor-layer-body"><div class="emoticon-wrap"><ul class="emoticon-list">${t}</ul></div></div></div>`),e.emoticon_layer=$("#emoticonLayer1"),$(".emoticon-list .emoticon-items").on("click",function(t){e.add_emoticon($(this))}),$("#emoticonLayer1 .fe-btn.fe-btn-close").on("click",function(t){e.hide_emoticon()}),$("body").mouseup(function(t){e.emoticon_layer.has(t.target).length||e.hide_emoticon(),eventStop(t)})}show_emoticon(){this.emoticon_layer.hasClass("active")||($(".dimmed").css("display","block"),$("body").css("overflow","hidden"),this.emoticon_layer.addClass("active"))}hide_emoticon(){this.emoticon_layer.hasClass("active")&&($(".dimmed").css("display","none"),$("body").css("overflow",""),this.emoticon_layer.removeClass("active"))}add_emoticon(e){let t=$(e).children("img").attr("src");this.editor.summernote("pasteHTML",`<img src="${t}" width="140" height="140" alt="">`),this.hide_emoticon()}image_upload(e){let t=this,i=$("#dividPath").val();for(var c=0;c<e.length;c++){if(e[c].size>=3145728){popupShow("이미지는 3MB이하로 등록하십시오.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}!function(c){var s=new FormData;s.append("uploadFile",e[c]),s.append("dividPath",i),getDatasWithOption([{type:"POST",url:"/define/editor/upload",contentType:!1,processData:!1,cache:!1,data:s}],e=>{e?(e=e.replaceAll("\\","/"),t.editor.summernote("editor.insertImage",e),t.images.push(e)):popupShow("이미지는 1MB이하로 등록하십시오.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},e=>{console.log("fail upload")})}(c)}}setSubmit(){this.is_submit=!0}addEvents(){let e=this;window.addEventListener("beforeunload",function(t){if(e.is_submit||!e.images||e.images.length<=0)return;let i={content:$("#oriContent").val(),images:e.images,is_insert:e.is_insert};getDatasWithOption([{type:"POST",url:"/define/editor/cancel",dataType:"json",contentType:"application/json",Accept:"application/json",data:i,cache:!1}],null,null)})}}